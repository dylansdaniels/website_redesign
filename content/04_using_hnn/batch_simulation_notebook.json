{
    "full_executed": true,
    "batch_simulation_notebook.ipynb": {
        "4.5: Batch Simulation": {
            "level": 1,
            "html": "<div class='markdown-cell'>\n    <h1>4.5: Batch Simulation</h1>\n<p>This example shows how to do batch simulations in HNN-core, allowing\nusers to efficiently run multiple simulations with different parameters\nfor comprehensive analysis.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        # Authors: Abdul Samad Siddiqui <abdulsamadsid1@gmail.com>\n#          Nick Tolley <nicholas_tolley@brown.edu>\n#          Ryan Thorpe <ryan_thorpe@brown.edu>\n#          Mainak Jas <mjas@mgh.harvard.edu>\n#\n# This project was supported by Google Summer of Code (GSoC) 2024.\n    </code>\n</div>\n<div class='markdown-cell'>\n    <p>Let us import <code>hnn_core</code>.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        import matplotlib.pyplot as plt\nimport numpy as np\nfrom hnn_core.batch_simulate import BatchSimulate\nfrom hnn_core import jones_2009_model\n\n# The number of cores may need modifying depending on your current machine.\nn_jobs = 4\n    </code>\n</div>\n<div class='markdown-cell'>\n    <p>The <code>add_evoked_drive</code> function simulates external input\nto the network, mimicking sensory stimulation or other external\nevents.</p>\n<ul>\n<li><code>evprox</code> indicates a proximal drive, targeting dendrites\nnear the cell bodies.</li>\n<li><code>mu=40</code> and <code>sigma=5</code> define the timing (mean\nand spread) of the input.</li>\n<li><code>weights_ampa</code> and <code>synaptic_delays</code> control\nthe strength and timing of the input.</li>\n</ul>\n<p>This evoked drive causes the initial positive deflection in the\ndipole signal, triggering a cascade of activity through the network and\nresulting in the complex waveforms observed.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        def set_params(param_values, net=None):\n    \"\"\"\n    Set parameters for the network drives.\n\n    Parameters\n    ----------\n    param_values : dict\n        Dictionary of parameter values.\n    net : instance of Network, optional\n        If None, a new network is created using the specified model type.\n    \"\"\"\n    weights_ampa = {'L2_basket': param_values['weight_basket'],\n                    'L2_pyramidal': param_values['weight_pyr'],\n                    'L5_basket': param_values['weight_basket'],\n                    'L5_pyramidal': param_values['weight_pyr']}\n\n    synaptic_delays = {'L2_basket': 0.1, 'L2_pyramidal': 0.1,\n                       'L5_basket': 1., 'L5_pyramidal': 1.}\n\n    # Add an evoked drive to the network.\n    net.add_evoked_drive('evprox',\n                         mu=40,\n                         sigma=5,\n                         numspikes=1,\n                         location='proximal',\n                         weights_ampa=weights_ampa,\n                         synaptic_delays=synaptic_delays)\n    </code>\n</div>\n<div class='markdown-cell'>\n    <p>Next, we define a parameter grid for the batch simulation.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        param_grid = {\n    'weight_basket': np.logspace(-4, -1, 20),\n    'weight_pyr': np.logspace(-4, -1, 20)\n}\n    </code>\n</div>\n<div class='markdown-cell'>\n    <p>We then define a function to calculate summary statistics.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        def summary_func(results):\n    \"\"\"\n    Calculate the min and max dipole peak for each simulation result.\n\n    Parameters\n    ----------\n    results : list\n        List of dictionaries containing simulation results.\n\n    Returns\n    -------\n    summary_stats : list\n        Summary statistics for each simulation result.\n    \"\"\"\n    summary_stats = []\n    for result in results:\n        dpl_smooth = result['dpl'][0].copy().smooth(window_len=30)\n        dpl_data = dpl_smooth.data['agg']\n        min_peak = np.min(dpl_data)\n        max_peak = np.max(dpl_data)\n        summary_stats.append({'min_peak': min_peak, 'max_peak': max_peak})\n    return summary_stats\n    </code>\n</div>\n<div class='markdown-cell'>\n    <p>Run the batch simulation and collect the results.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        # Initialize the network model and run the batch simulation.\nnet = jones_2009_model(mesh_shape=(3, 3))\nbatch_simulation = BatchSimulate(net=net,\n                                 set_params=set_params,\n                                 summary_func=summary_func)\nsimulation_results = batch_simulation.run(param_grid,\n                                          n_jobs=n_jobs,\n                                          combinations=False,\n                                          backend='loky')\n\nprint(\"Simulation results:\", simulation_results)\n    </code>\n</div>\n<div class='output-cell'><div class='output-label'>\n    Out:\n</div>\n    <div class='output-code'>\n        [Parallel(n_jobs=4)]: Using backend LokyBackend with 4 concurrent workers.\n\n        Joblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nLoading custom mechanism files from /Users/austinsoplata/rep/brn/hnn-core/hnn_core/mod/arm64/.libs/libnrnmech.so\nBuilding the NEURON model\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nLoading custom mechanism files from /Users/austinsoplata/rep/brn/hnn-core/hnn_core/mod/arm64/.libs/libnrnmech.so\nBuilding the NEURON model\n[Done]\nTrial 1: 0.03 ms...\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\n[Done]\nLoading custom mechanism files from /Users/austinsoplata/rep/brn/hnn-core/hnn_core/mod/arm64/.libs/libnrnmech.so\nBuilding the NEURON model\nTrial 1: 0.03 ms...\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nLoading custom mechanism files from /Users/austinsoplata/rep/brn/hnn-core/hnn_core/mod/arm64/.libs/libnrnmech.so\nBuilding the NEURON model\nTrial 1: 10.0 ms...\n[Done]\nTrial 1: 0.03 ms...\nTrial 1: 10.0 ms...\n[Done]\nTrial 1: 0.03 ms...\nTrial 1: 20.0 ms...\nTrial 1: 10.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 10.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 160.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 160.0 ms...\nTrial 1: 150.0 ms...\n[Parallel(n_jobs=4)]: Done   1 tasks      | elapsed:    2.6s\nTrial 1: 160.0 ms...\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\nTrial 1: 160.0 ms...\n[Parallel(n_jobs=4)]: Done   2 tasks      | elapsed:    2.6s\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\n[Done]\nTrial 1: 0.03 ms...\n[Parallel(n_jobs=4)]: Done   3 tasks      | elapsed:    2.6s\n[Parallel(n_jobs=4)]: Done   4 tasks      | elapsed:    2.6s\n[Done]\nTrial 1: 0.03 ms...\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\nTrial 1: 10.0 ms...\n[Done]\nTrial 1: 0.03 ms...\nTrial 1: 10.0 ms...\n[Done]\nTrial 1: 0.03 ms...\nTrial 1: 20.0 ms...\nTrial 1: 10.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 10.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 160.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 160.0 ms...\nTrial 1: 150.0 ms...\n[Parallel(n_jobs=4)]: Done   5 tasks      | elapsed:    3.3s\nTrial 1: 160.0 ms...\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\n[Parallel(n_jobs=4)]: Done   6 tasks      | elapsed:    3.3s\nTrial 1: 160.0 ms...\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\n[Done]\nTrial 1: 0.03 ms...\n[Parallel(n_jobs=4)]: Done   7 tasks      | elapsed:    3.3s\n[Done]\nTrial 1: 0.03 ms...\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\n[Parallel(n_jobs=4)]: Done   8 tasks      | elapsed:    3.3s\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\nTrial 1: 10.0 ms...\n[Done]\nTrial 1: 0.03 ms...\nTrial 1: 10.0 ms...\n[Done]\nTrial 1: 0.03 ms...\nTrial 1: 20.0 ms...\nTrial 1: 10.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 10.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 160.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 160.0 ms...\nTrial 1: 150.0 ms...\n[Parallel(n_jobs=4)]: Done   9 tasks      | elapsed:    4.0s\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\nTrial 1: 160.0 ms...\n[Parallel(n_jobs=4)]: Done  10 tasks      | elapsed:    4.0s\nTrial 1: 160.0 ms...\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\n[Done]\nTrial 1: 0.03 ms...\n[Done]\n[Parallel(n_jobs=4)]: Done  11 tasks      | elapsed:    4.0s\nTrial 1: 0.03 ms...\n[Parallel(n_jobs=4)]: Done  12 tasks      | elapsed:    4.0s\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\nTrial 1: 10.0 ms...\n[Done]\nTrial 1: 0.03 ms...\nTrial 1: 10.0 ms...\n[Done]\nTrial 1: 0.03 ms...\nTrial 1: 20.0 ms...\nTrial 1: 10.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 10.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 160.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 160.0 ms...\nTrial 1: 150.0 ms...\n[Parallel(n_jobs=4)]: Done  13 tasks      | elapsed:    4.7s\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\nTrial 1: 160.0 ms...\n[Parallel(n_jobs=4)]: Done  14 out of  20 | elapsed:    4.7s remaining:    2.0s\nTrial 1: 160.0 ms...\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\n[Done]\nTrial 1: 0.03 ms...\n[Done]\n[Parallel(n_jobs=4)]: Done  15 out of  20 | elapsed:    4.7s remaining:    1.6s\nTrial 1: 0.03 ms...\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\n[Parallel(n_jobs=4)]: Done  16 out of  20 | elapsed:    4.7s remaining:    1.2s\nJoblib will run 1 trial(s) in parallel by distributing trials over 1 jobs.\nBuilding the NEURON model\nTrial 1: 10.0 ms...\n[Done]\nTrial 1: 0.03 ms...\nTrial 1: 10.0 ms...\n[Done]\nTrial 1: 0.03 ms...\nTrial 1: 20.0 ms...\nTrial 1: 10.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 10.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 20.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 30.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 40.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 50.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 60.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 70.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 80.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 90.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 100.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 110.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 120.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 130.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 140.0 ms...\nTrial 1: 160.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 150.0 ms...\nTrial 1: 160.0 ms...\n[Parallel(n_jobs=4)]: Done  17 out of  20 | elapsed:    5.4s remaining:    0.9s\nTrial 1: 160.0 ms...\nTrial 1: 160.0 ms...\n[Parallel(n_jobs=4)]: Done  18 out of  20 | elapsed:    5.4s remaining:    0.6s\n[Parallel(n_jobs=4)]: Done  20 out of  20 | elapsed:    5.4s finished\nSimulation results: {&#x27;summary_statistics&#x27;: [[{&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 2.438299811172476e-05}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 3.5625970074068226e-05}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 5.187123572695806e-05}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 7.53973769021332e-05}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 0.00010962271639761108}, {&#x27;min_peak&#x27;: -0.000818709814074504, &#x27;max_peak&#x27;: 0.0011853731897260855}, {&#x27;min_peak&#x27;: -0.0006900911098816319, &#x27;max_peak&#x27;: 0.001453236614203411}, {&#x27;min_peak&#x27;: -7.443630674152589e-05, &#x27;max_peak&#x27;: 0.0006303483688791772}, {&#x27;min_peak&#x27;: -0.0003831247250500106, &#x27;max_peak&#x27;: 0.0015588783545865915}, {&#x27;min_peak&#x27;: -0.0005827286517535978, &#x27;max_peak&#x27;: 0.0014794795458269567}, {&#x27;min_peak&#x27;: -0.0005759203533290788, &#x27;max_peak&#x27;: 0.0014539235295249035}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 0.0013262182394243836}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 0.001328331309960044}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 0.0011853462053579697}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 0.001164963332945789}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 0.001184585414815396}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 0.001231155285096099}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 0.0013115554222262646}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 0.0014314315232221647}, {&#x27;min_peak&#x27;: -1.9487233699163027e-05, &#x27;max_peak&#x27;: 0.001512378997571946}]], &#x27;simulated_data&#x27;: [[{&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.0001, &#x27;weight_pyr&#x27;: 0.0001}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127de9250&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.0001438449888287663, &#x27;weight_pyr&#x27;: 0.0001438449888287663}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127df2210&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.00020691380811147902, &#x27;weight_pyr&#x27;: 0.00020691380811147902}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127df4530&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.00029763514416313193, &#x27;weight_pyr&#x27;: 0.00029763514416313193}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127df32c0&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.00042813323987193956, &#x27;weight_pyr&#x27;: 0.00042813323987193956}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127df55b0&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.0006158482110660267, &#x27;weight_pyr&#x27;: 0.0006158482110660267}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127df6d20&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.0008858667904100823, &#x27;weight_pyr&#x27;: 0.0008858667904100823}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127df0200&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.0012742749857031334, &#x27;weight_pyr&#x27;: 0.0012742749857031334}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127de8e30&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.0018329807108324356, &#x27;weight_pyr&#x27;: 0.0018329807108324356}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127df9fa0&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.0026366508987303583, &#x27;weight_pyr&#x27;: 0.0026366508987303583}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x12e9334d0&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.00379269019073225, &#x27;weight_pyr&#x27;: 0.00379269019073225}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127dec8f0&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.005455594781168515, &#x27;weight_pyr&#x27;: 0.005455594781168515}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127df5a30&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.007847599703514606, &#x27;weight_pyr&#x27;: 0.007847599703514606}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x12e8a64b0&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.011288378916846883, &#x27;weight_pyr&#x27;: 0.011288378916846883}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127def7a0&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.01623776739188721, &#x27;weight_pyr&#x27;: 0.01623776739188721}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x12e930680&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.023357214690901212, &#x27;weight_pyr&#x27;: 0.023357214690901212}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x12e931730&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.03359818286283781, &#x27;weight_pyr&#x27;: 0.03359818286283781}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x12ea9a360&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.04832930238571752, &#x27;weight_pyr&#x27;: 0.04832930238571752}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x12ea9b440&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.06951927961775606, &#x27;weight_pyr&#x27;: 0.06951927961775606}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127df84d0&gt;]}, {&#x27;net&#x27;: &lt;Network | 3 x 3 Pyramidal cells (L2, L5)\n3 L2 basket cells\n3 L5 basket cells&gt;, &#x27;param_values&#x27;: {&#x27;weight_basket&#x27;: 0.1, &#x27;weight_pyr&#x27;: 0.1}, &#x27;dpl&#x27;: [&lt;hnn_core.dipole.Dipole object at 0x127de9640&gt;]}]]}\n\n    </div>\n</div>\n<div class='markdown-cell'>\n    <p>This plot shows an overlay of all smoothed dipole waveforms from the\nbatch simulation. Each line represents a different set of synaptic\nstrength parameters (<code>weight_basket</code>), allowing us to\nvisualize the range of responses across the parameter space. The\ncolormap represents synaptic strengths, from weaker (purple) to stronger\n(yellow).</p>\n<p>As drive strength increases, dipole responses show progressively\nlarger amplitudes and more distinct features, reflecting heightened\nnetwork activity. Weak drives (purple lines) produce smaller amplitude\nsignals with simpler waveforms, while stronger drives (yellow lines)\ngenerate larger responses with more pronounced oscillatory features,\nindicating more robust network activity.</p>\n<p>The y-axis represents dipole amplitude in <code>nAm</code>\n(nanoAmpere-meters), which is the product of current flow and distance\nin the neural tissue.</p>\n<p>Stronger synaptic connections (yellow lines) generally show larger\namplitude responses and more pronounced features throughout the\nsimulation.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        dpl_waveforms, param_values = [], []\nfor data_list in simulation_results['simulated_data']:\n    for data in data_list:\n        dpl_smooth = data['dpl'][0].copy().smooth(window_len=30)\n        dpl_waveforms.append(dpl_smooth.data['agg'])\n        param_values.append(data['param_values']['weight_basket'])\n\nplt.figure(figsize=(10, 6))\ncmap = plt.get_cmap('viridis')\nlog_param_values = np.log10(param_values)\nnorm = plt.Normalize(log_param_values.min(), log_param_values.max())\n\nfor waveform, log_param in zip(dpl_waveforms, log_param_values):\n    color = cmap(norm(log_param))\n    plt.plot(waveform, color=color, alpha=0.7, linewidth=2)\nplt.title('Overlay of Dipole Waveforms')\nplt.xlabel('Time (ms)')\nplt.ylabel('Dipole Amplitude (nAm)')\nplt.grid(True)\nplt.tight_layout()\nplt.show()\n    </code>\n</div>\n<div class='output-cell'><div class='output-label'>\n    Out:\n</div>\n    <div class='output-code'>\n        &lt;Figure size 1000x600 with 1 Axes&gt;\n    </div>\n</div>\n<div class='output-cell'>\n    <img src='output_nb_batch_simulation_notebook/fig_01.png'/>\n</div>\n<div class='markdown-cell'>\n    <p>This plot displays the minimum and maximum dipole peaks across\ndifferent synaptic strengths. This allows us to see how the range of\ndipole activity changes as we vary the synaptic strength parameter.</p>\n\n</div>\n<div class='code-cell'>\n    <code class='language-python'>\n        min_peaks, max_peaks, param_values = [], [], []\nfor summary_list, data_list in zip(simulation_results['summary_statistics'],\n                                   simulation_results['simulated_data']):\n    for summary, data in zip(summary_list, data_list):\n        min_peaks.append(summary['min_peak'])\n        max_peaks.append(summary['max_peak'])\n        param_values.append(data['param_values']['weight_basket'])\n\n# Plotting\nplt.figure(figsize=(10, 6))\nplt.plot(param_values, min_peaks, label='Min Dipole Peak')\nplt.plot(param_values, max_peaks, label='Max Dipole Peak')\nplt.xlabel('Synaptic Strength (nS)')\nplt.ylabel('Dipole Peak Magnitude')\nplt.title('Min and Max Dipole Peaks across Simulations')\nplt.legend()\nplt.grid(True)\nplt.xscale('log')\nplt.tight_layout()\nplt.show()\n    </code>\n</div>\n<div class='output-cell'><div class='output-label'>\n    Out:\n</div>\n    <div class='output-code'>\n        &lt;Figure size 1000x600 with 1 Axes&gt;\n    </div>\n</div>\n<div class='output-cell'>\n    <img src='output_nb_batch_simulation_notebook/fig_02.png'/>\n</div>"
        }
    }
}