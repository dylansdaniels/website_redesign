<html><body>
<div class='markdown-cell'>
	<h1>9.4: Animating HNN simulations</h1>
<p>This example demonstrates how to animate HNN simulations</p>

</div>
<div class='code-cell'>
	<code class='language-python'>
		# Author: Nick Tolley <nicholas_tolley@brown.edu>
	</code>
</div>
<div class='markdown-cell'>
	<p>First, we'll import the necessary modules for instantiating a network
and running a simulation that we would like to animate.</p>

</div>
<div class='code-cell'>
	<code class='language-python'>
		import os.path as op

import hnn_core
from hnn_core import jones_2009_model, simulate_dipole, read_params
from hnn_core.network_models import add_erp_drives_to_jones_model
	</code>
</div>
<div class='markdown-cell'>
	<p>We begin by instantiating the network. For this example, we will
reduce the number of cells in the network to speed up the
simulations.</p>

</div>
<div class='code-cell'>
	<code class='language-python'>
		net = jones_2009_model(mesh_shape=(3, 3))

# Note that we move the cells further apart to allow better visualization of
# the network (default inplane_distance=1.0 Âµm).
net.set_cell_positions(inplane_distance=300)
	</code>
</div>
<div class='markdown-cell'>
	<p>The :class:<code>hnn_core.viz.NetworkPlotter</code> class can be used
to visualize the 3D structure of the network.</p>

</div>
<div class='code-cell'>
	<code class='language-python'>
		from hnn_core.viz import NetworkPlotter

net_plot = NetworkPlotter(net)
net_plot.fig
	</code>
</div>
<div class='markdown-cell'>
	<p>We can also visualize the network from another angle by adjusting the
azimuth and elevation parameters.</p>

</div>
<div class='code-cell'>
	<code class='language-python'>
		net_plot.azim = 45
net_plot.elev = 40
net_plot.fig
	</code>
</div>
<div class='markdown-cell'>
	<p>Next we add event related potential (ERP) producing drives to the
network and run the simulation (see
<code>evoked example &amp;lt;sphx_glr_auto_examples_plot_simulate_evoked.py&amp;gt;</code>
for more details). To visualize the membrane potential of cells in the
network, we need use
<code>simulate_dipole(..., record_vsec=&amp;#x27;all&amp;#x27;)</code>
which turns on the recording of voltages in all sections of all cells in
the network.</p>

</div>
<div class='code-cell'>
	<code class='language-python'>
		add_erp_drives_to_jones_model(net)
dpl = simulate_dipole(net, tstop=170, record_vsec='all')
net_plot = NetworkPlotter(net)  # Reinitialize plotter with simulated network
	</code>
</div>
<div class='markdown-cell'>
	<p>Finally, we can animate the simulation using the
<code>export_movie()</code> method. We can adjust the xyz limits of the
plot to better visualize the network.</p>

</div>
<div class='code-cell'>
	<code class='language-python'>
		# # If you want to save the animation to a file, then uncomment the code in this cell.
# net_plot.xlim = (400, 1600)
# net_plot.ylim = (400, 1600)
# net_plot.zlim = (-500, 1600)
# net_plot.azim = 225
# net_plot.export_movie('animation_demo.gif', dpi=100, fps=30, interval=100)
	</code>
</div>
</body></html>