<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HNN Textbook</title>
    <!-- <base href="/website_redesign/"> -->
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../assets/styles.css">
</head>
<body>

	<div id="mySidebar" class="sidebar">
		<div class="navbar-header">
		<a>
			Human Neocortical Neurosolver
		</a>
		<br>
			<svg class="collapse-icon" viewBox="0 0 16 16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16">
				<path d="M9 9H4v1h5V9z"/>
				<path fill-rule="evenodd" clip-rule="evenodd" d="M5 3l1-1h7l1 1v7l-1 1h-2v2l-1 1H3l-1-1V6l1-1h2V3zm1 2h4l1 1v4h2V3H6v2zm4 1H3v7h7V6z"/>
			</svg>
		</div>
		<a href="https://dylansdaniels.github.io/website_redesign/tests/workshop.html">
		<div>
			<code class="workshop-button">April 9th Workshop Page</code>
		</div>
		</a>
		<a href="/website_redesign/content/preface.html">Preface</a>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				1. Getting Started
			</a>
			<div class="submenu">
				<a href="/website_redesign/content/01_getting_started/challenge.html">1.1 Introducing HNN</a>
				<a href="/website_redesign/content/01_getting_started/template_model.html">1.2 Template Model</a>
				<a href="/website_redesign/content/01_getting_started/installation.html">1.3 Installation</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				2. Model Assumptions
			</a>
			<div class="submenu">
				<a href="/website_redesign/content/03_model_assumptions/cortical_column_structure.html">2.1 Cortical Column Structure</a>
				<a href="/website_redesign/content/03_model_assumptions/primary_electric_currents.html">2.2 Primary Electrical Currents</a>
				<a href="/website_redesign/content/03_model_assumptions/neurons_morphology_and_physiology.html">2.3 Neurons: Morphology and Physiology</a>
				<a href="/website_redesign/content/03_model_assumptions/synaptic_connectivity.html">2.4 Synaptic Connectivity</a>
				<a href="/website_redesign/content/03_model_assumptions/evoked_and_rhythmic_driving_inputs.html">2.5 Evoked and Rhythmic Driving Inputs</a>
				<a href="/website_redesign/content/03_model_assumptions/tonic_and_noisy_driving_inputs.html">2.6 Tonic and Noisy Driving Inputs</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				3. Simulating ERPs
			</a>
			<div class="submenu">
				<a href="/website_redesign/content/05_erps/erps_in_gui.html">3.1 GUI Tutorial of ERPs Simulation</a>
				<a href="/website_redesign/content/05_erps/hnn_core.html">3.2 API Tutorial of ERPs Simulation</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				4. Simulating Alpha/Beta Rhythms
			</a>
			<div class="submenu">
				<a href="/website_redesign/content/06_alpha_beta/gui.html">4.1 GUI Tutorial of Alpha/Beta Rhythms</a>
				<a href="/website_redesign/content/06_alpha_beta/api.html">4.2 API Tutorial of Alpha/Beta Rhythms</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				5. Simulating Gamma Rhythms
			</a>
			<div class="submenu">
				<a href="/website_redesign/content/07_gamma/gamma_in_gui.html">5.1 GUI Tutorial of Gamma Rhythms</a>
				<a href="/website_redesign/content/07_gamma/gamma_in_api.html">5.2 API Tutorial of Gamma Rhythms</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				6. From Data to Simulation
			</a>
			<div class="submenu">
				<a href="/website_redesign/content/08_data_to_simulation/from_meg_to_hnn.html">6.1 From MEG sensor-space data to HNN simulation</a>
			</div>
		</div>
		<div class="sidebar-list">
			<a id="sidebar-header" onclick="toggleSubmenu(event)">
		<span class="toggle-icon">+</span>
				7. Feature Demos
			</a>
			<div class="submenu">
				<a href="/website_redesign/content/09_feature_demos/plot_firing_pattern.html">7.1 Plot Firing Pattern</a>
				<a href="/website_redesign/content/09_feature_demos/record_and_plot_extracellular_potentials.html">7.2 Record & Plot Extracellular Potentials</a>
				<a href="/website_redesign/content/09_feature_demos/modifying_local_connectivity.html">7.3 Modifying Local Connectivity</a>
				<a href="/website_redesign/content/09_feature_demos/animating_hnn_simulations.html">7.4 Animating HNN Simulations</a>
				<a href="/website_redesign/content/09_feature_demos/batch_simulation.html">7.5 Batch Simulation</a>
				<a href="/website_redesign/content/09_feature_demos/simulate_beta_modulated_erp.html">7.6 Simulate Beta-modulated ERP</a>
				<a href="/website_redesign/content/09_feature_demos/use_mpi_backend_for_parallelization.html">7.7 Use MPI Backend for Parallelization</a>
				<a href="/website_redesign/content/09_feature_demos/optimize_simulated_evoked_response_parameters.html">7.8 Optimize simulated evoked response parameters</a>
				<a href="/website_redesign/content/09_feature_demos/optimize_simulated_rhythmic_response_parameters.html">7.9 Optimize simulated rhythmic response parameters</a>
			</div>
		</div>
	<div style='height: 30px;'></div>
	</div>


    <div class="topbar">
        
        <!-- Topbar menu -->
        <div class="menu-container">
            <div class="menu-icons">
                <button class="openbtn" onclick="toggleNav()">
                    ☰
                </button>
                <a href="" class="home-link">
                    <div class="home-icon-container">
                        <svg
                            xmlns="http://www.w3.org/2000/svg"
                            width="24" 
                            height="24"
                            viewBox="0 0 24 24" 
                            class="home-icon">
                            <path
                                d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"
                            />
                        </svg>
                    </div>
                </a>
                <button class="theme-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                        <path d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"></path>
                    </svg>
                </button>
                <div class="dropdown">
                    <button 
                        id="dropdownButton" 
                        class="dropdown-button">
                            <img
                                src="/website_redesign/content/assets/icons/fontsize.png"
                                alt="fontsize"
                            />
                    </button>
                    <div class="dropdown-content">
                        <button 
                            class="fontsize-btn" 
                            onclick="decreaseFontSize()">
                            <img
                                src="/website_redesign/content/assets/icons/fontminus.png"
                                alt="fontminus"
                            />
                        </button>
                        <button 
                            class="fontsize-btn" 
                            onclick="increaseFontSize()">
                            <img
                                src="/website_redesign/content/assets/icons/fontplus.png"
                                alt="fontplus"
                            />
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Topbar image -->
        <div class="topbar-logo-container">
            <img 
                id="topbar-logo"
                src="https://hnn.brown.edu/wp-content/uploads/hnn-medium.png"
            />
        </div>

        <!-- Right side of topbar -->
        <div class="socials-container">
            <div class="social-icons">
                <a 
                    href="https://github.com/jonescompneurolab/hnn-core" 
                    target="_blank" 
                    aria-label="GitHub">
                    <img 
                        src="/website_redesign/content/assets/icons/github.png"
                        alt="GitHub">
                </a>
                <a 
                    href="https://bsky.app/profile/hnnsolver.bsky.social" 
                    target="_blank"
                    aria-label="BlueSky">
                    <img 
                        src="/website_redesign/content/assets/icons/bluesky.png"
                        alt="BlueSky">
                </a>
                <a 
                    href="https://www.linkedin.com/company/human-neocortical-neurosolver/" 
                    target="_blank"
                    aria-label="LinkedIn">
                    <img 
                        src="/website_redesign/content/assets/icons/linkedin.png"
                        alt="LinkedIn">
                </a>
            </div>
        </div>
    </div>

    <div id="main">
    <div id="content-wrapper">
    <div id="content">

<!--
# Title: 4.1 GUI Tutorial of Alpha/Beta Rhythms
# Updated: 2025-02-04
#
# Contributors:
# Nick Tolley
# Dylan Daniels
-->
<!-- this markdown file and images originally adapted from https://github.com/jonescompneurolab/hnn-tutorials/tree/core-gui/coregui_alpha_and_beta -->
<h1>4.1 GUI Tutorial of Alpha/Beta Rhythms</h1>
<h2>Tutorial Table of Contents</h2>
<ol type="1">
<li><p><a href="#toc-1">Background</a></p></li>
<li><p><a href="#toc-2">Downloading HNN Parameter Set Files</a></p></li>
<li><p><a href="#toc-3">Setting Initial Simulation and Visualization
Parameters</a></p></li>
<li><p><a href="#toc-4">Simulating Rhythmic Proximal Inputs: Alpha
only</a></p></li>
<li><p><a href="#toc-5">Simulation Rhythmic Distal Inputs: Alpha
only</a></p></li>
<li><p><a href="#toc-6">Simulating Combined Rhythmic Proximal and Distal
Inputs: Alpha/Beta Complex</a></p></li>
</ol>
<!-- Currently, commenting out section 7, see this: https://github.com/jonescompneurolab/hnn-core/issues/1039 -->
<!-- 7. [Calculating and Viewing Power Spectral Density (PSD)](#toc-7) -->
<!-- Currently, commenting out section 8, see note near it for details. -->
<!-- 8. [Comparing model output and recorded data](#toc-8) -->
<!-- 9. [Adjusting parameters](#toc-9) -->
<!-- 8. [Adjusting parameters](#toc-9) -->
<ol start="7" type="1">
<li><a href="#toc-9">Adjusting parameters</a></li>
</ol>
<!-- 10. [Have fun exploring your own data!](#toc-10) -->
<!-- 9. [Have fun exploring your own data!](#toc-10) -->
<!-- 8. [Have fun exploring your own data!](#toc-10) -->
<p><a id="toc-1"></a></p>
<h2>1. Background</h2>
<p>In order to understand the workflow and initial parameter sets
provided with this tutorial, we must first briefly describe prior
studies that led to the creation of the data you will aim to simulate.
This tutorial is based on results from <span class="citation"
data-cites="jones_quantitative_2009">(<a
href="#ref-jones_quantitative_2009" role="doc-biblioref">Stephanie R.
Jones et al. 2009</a>)</span> where, using MEG, we recorded spontaneous
(pre-stimulus) alpha (7-14 Hz) and beta (15-29 Hz) rhythms that arise as
part of the mu-complex from the primary somatosensory cortex (S1) <span
class="citation" data-cites="jones_quantitative_2009">(<a
href="#ref-jones_quantitative_2009" role="doc-biblioref">Stephanie R.
Jones et al. 2009</a>)</span>. (<a href="#figure-1">Figure 1</a>, See
also <span class="citation"
data-cites="ziegler_transformations_2010">(<a
href="#ref-ziegler_transformations_2010" role="doc-biblioref">Ziegler et
al. 2010</a>)</span>, <span class="citation"
data-cites="sherman_neural_2016">(<a href="#ref-sherman_neural_2016"
role="doc-biblioref">Sherman et al. 2016</a>)</span>, <span
class="citation" data-cites="jones_when_2016">(<a
href="#ref-jones_when_2016" role="doc-biblioref">Stephanie R. Jones
2016</a>)</span>.)</p>
<section class="stylefig">
<h3>Figure 1</h3>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image03.png" />
<p align="justify">
<strong>Figure 1 Left:</strong> Spectrogram of spontaneous activity from
current dipole source in SI averaged across 100 trials from an example
subject. The spectrogram shows nearly continuous prestimulus alpha and
beta oscillations. At time zero, a brief tap was given to the
contralateral finger tip, causing the spontaneous oscillations to
briefly desynchronize.
</p>
<p align="justify">
<strong>Figure 1 Right:</strong> A closer look at the prestimulus
waveform and spectrogram from spontaneous activity during individual
example signal trials. This illustrates that the alpha and beta
oscillations occur intermittently and are frequently non-overlapping.
</p>
<p align="justify">
All figures in Figure 1 are from <span class="citation"
data-cites="jones_quantitative_2009">(<a
href="#ref-jones_quantitative_2009" role="doc-biblioref">Stephanie R.
Jones et al. 2009</a>)</span> or related work.
</p>
</section>
<p>Our goal was to use our neocortical model to reproduce features of
the waveform and spectrogram observed on single (un-averaged) trials (<a
href="#figure-1">Figure 1</a>, middle and right columns), where the
alpha and beta components emerge briefly and intermittently in time. On
any individual trial (i.e., 1 second of spontaneous, pre-stimulus data),
the presence of alpha and beta activity is not time-locked and is
representative of so-called “induced” activity. The alpha and beta bands
of activity appear continuous when averaging the spectrograms across
trials (<a href="#figure-1">Figure 1</a>, left column), but this is due
to the fact that the spectrograms values are strictly positive and the
alpha and beta events accumulate without cancellation <span
class="citation" data-cites="jones_when_2016">(<a
href="#ref-jones_when_2016" role="doc-biblioref">Stephanie R. Jones
2016</a>)</span>. For individual trials, alpha and beta power is
simultaneously high only around 50% of the time, as shown in <a
href="#figure-2">Figure 2</a>.</p>
<section class="stylefig">
<h3>Figure 2</h3>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/old-image29.png" />
<p align="justify">
<strong>Figure 2</strong>: Key features of the spontaneous non-average
SI alpha/beta complex include: intermittent transient bouts of
alpha/beta activity, a waveform that oscillates around 0 nAm, power
spectral densities (PSD) with peaks in the alpha and beta bands,
primarily non-overlapping alpha and beta events, and a symmetric
waveform oscillation. The model was able to reproduce each of these
features. The subplots in the top row are from experimental MEG data
exhibiting these features, while the corresponding subplots in the
bottom row are from simulations of the model. See <span class="citation"
data-cites="jones_quantitative_2009">(<a
href="#ref-jones_quantitative_2009" role="doc-biblioref">Stephanie R.
Jones et al. 2009</a>)</span>.
</p>
</section>
<p>We found that a sequence of exogenous subthreshold excitatory
synaptic drive could activate the network in a manner that reproduced
important features of the SI rhythms in the model (<a
href="#figure-2">Figure 2</a>). This drive consisted of two
nearly-synchronous 10 Hz rhythmic drives that contacted the network
through proximal and distal projection pathways (<a
href="#figure-3">Figure 3</a>, see also <a
href="03_model_assumptions/evoked_and_rhythmic_driving_inputs.html">Textbook
Section 2.5: Evoked and Rhythmic Driving Inputs</a>). The drives were
simulated as population “bursts” of action potentials that contacted the
network every 100ms with the mean delay between the proximal and distal
burst of 0ms. Specifically, as shown schematically in <a
href="#figure-3">Figure 3</a>, these 10 population bursts consisted of
2-spike bursts (i.e. spike “doublets”), Gaussian distributed in time. We
presumed that during such spontaneous activity, these drives may be
provided by leminscial and non-lemniscal thalamic nuclei, which contact
proximal and distal pyramidal neurons respectively, and they are know to
burst fire at ~10 Hz frequencies in spontaneous states (<span
class="citation" data-cites="jones_thalamic_2001">(<a
href="#ref-jones_thalamic_2001" role="doc-biblioref">E. G. Jones
2001</a>)</span>, <span class="citation"
data-cites="hughes_thalamic_2005">(<a href="#ref-hughes_thalamic_2005"
role="doc-biblioref">Hughes and Crunelli 2005</a>)</span>).</p>
<section class="stylefig">
<h3>Figure 3</h3>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image04.png" />
<p align="justify">
<strong>Figure 3</strong>: Schematic illustration of exogenous 10 Hz
burst drives through proximal and distal projection pathways.
“Population bursts”, consisting of a set number of “burst units” (10
instances of 2-spike bursts as shown) drive post-synaptic conductances
in the local network with a set frequency (100 ms inter-burst-interval,
equal to 10 Hz) and a variable mean delay between proximal and distal
drives.
</p>
</section>
<p>We assumed that the macroscale rhythms generating the observed alpha
and beta activity arose from subthreshold current flow in a large
population of neurons, as opposed to being generated by local spiking
interaction <span class="citation"
data-cites="zhu_relationship_2009">(<a href="#ref-zhu_relationship_2009"
role="doc-biblioref">Zhu et al. 2009</a>)</span>. As such, the effective
strengths of the exogenous driving inputs were tuned so that the cells
in the network remained subthreshold (all other parameters were tuned
and fixed based on the morphology, physiology, and connectivity within
layered neocortical circuits, see <span class="citation"
data-cites="jones_quantitative_2009">(<a
href="#ref-jones_quantitative_2009" role="doc-biblioref">Stephanie R.
Jones et al. 2009</a>)</span> for details). The inputs drove
subthreshold currents up (proximal) and down (distal) the pyramidal
neurons in order to reproduce accurate waveform and spectrogram features
(see <a href="#figure-3">Figure 3</a>). A scaling factor of 3000 was
multiplied by the model waveform to reproduce a signal in units of nAm,
comparable to the recorded data, suggesting that on the order of 200 x
3000 = 600,000 pyramidal neurons contributed to this signal.</p>
<p>We further found that increasing the strength and synchrony of the
distal drive created stronger beta activity, but increasing the delay
between the drives to ~50ms created a pure alpha oscillation (see <a
href="#toc-9">Section 7</a> below). The former result led to the novel
prediction that brief beta events emerge when a broad proximal drive is
disrupted by a simultaneous strong distal drive lasting 50ms (i.e., one
beta period). Support for this prediction was found invasively with
laminar recordings in mice and monkeys <span class="citation"
data-cites="sherman_neural_2016">(<a href="#ref-sherman_neural_2016"
role="doc-biblioref">Sherman et al. 2016</a>)</span>.</p>
<p>In this tutorial, we will explore parameter changes that illustrate
these results. We will walk you step-by-step through simulations with
various combinations of rhythmic proximal and distal drives to describe
how each contributes to the alpha and beta components of the SI
alpha/beta complex. We will <strong>not</strong> be simulating evoked
responses or how alpha/beta oscillations interact with evoked responses;
<a href="../05_erps/erps_in_gui.html">click here for our GUI tutorial on
simulating evoked-response potentials (ERPs)</a>.</p>
<p>We will begin by simulating only rhythmic proximal 10 Hz inputs (<a
href="#toc-4">Section 4</a>), followed by simulating only distal 10 Hz
inputs (<a href="#toc-5">Section 5</a>), followed by various
combinations of proximal and distal drives to generate combinations of
alpha and beta rhythms (<a href="#toc-6">Section 6</a>). We’ll show you
how HNN can plot waveforms, time-frequency spectrograms, and power
spectral density plots of the simulated data.</p>
<p><a id="toc-2"></a></p>
<h2>2. Downloading HNN Parameter Set Files</h2>
<p>Throughout this tutorial, we will be using several different HNN
parameter set files. These files are not included in the HNN
installation, but instead must be downloaded separately, similar to the
files you downloaded in the Morning session of the workshop. The easiest
way to get them is to <a
href="https://download-directory.github.io/?url=https%3A%2F%2Fgithub.com%2Fjonescompneurolab%2Fhnn-data%2Ftree%2Fmain%2Fworkshops%2Falpha_beta_gui_walkthrough">click
this link, which will download a ZIP file that contains the four files
we need</a>. Alternatively, you can download (or <code>git clone</code>)
this Github repository: <a
href="https://github.com/jonescompneurolab/hnn-data">hnn-data</a> and
then access the files in the
<code>workshops/alpha_beta_gui_walkthrough</code> directory. These four
files are named <code>OnlyRhythmicProx.json</code>,
<code>OnlyRhythmicDist.json</code>, <code>AlphaAndBeta.json</code>, and
<code>AlphaAndBetaJitter50.json</code>.</p>
<p>Begin by starting the HNN GUI. If you are using <a
href="https://colab.research.google.com/drive/1yyjuEBimIu_f7_0Nf3YLwUiVOO7ZrKK3?usp=sharing">Google
Colab notebook</a>, follow the instructions there for starting and
accessing the GUI. If you are using a local install of HNN, run the
following command from a terminal:</p>
<pre><code>hnn-gui</code></pre>
<p><a id="toc-3"></a></p>
<h2>3. Setting Initial Simulation and Visualization Parameters</h2>
<p><strong>Before</strong> running any simulations, we need to change
some default parameters of both the simulations and visualizations. The
parameters we need to change in the <code>Simulation</code> tab are
shown in <a href="#figure-4">Figure 4</a> below, and are also listed
below. Please note that if you refresh the browser tab or restart HNN,
you will have to re-enter all of these parameter changes.</p>
<!-- 3. Change `Smoothing` to `0`. Without doing this, much of alpha- and beta-frequency content of our signal will be "smoothed out" and not viewable. -->
<ol type="1">
<li>Change the <code>Name</code> of the simulation to
<code>OnlyRhythmicProx</code> (or you can change it to whatever you
prefer).</li>
<li>Change <code>tstop (ms)</code> to <code>700</code>. This will
increase the length of the simulation to 700 milliseconds, and enable us
to see simulated oscillations as they evolve over longer time
periods.</li>
<li>Change <code>Dipole Smoothing</code> to <code>0</code>.</li>
<li>Change <code>Min Spectral Frequency (Hz)</code> to
<code>5</code>.</li>
<li>Change <code>Max Spectral Frequency (Hz)</code> to <code>40</code>.
These two changes will make it easier to see the alpha and beta
frequency ranges.</li>
<li>Only if you are using Mac or Linux (not Windows), and only if you
installed HNN locally using the instructions provided on the <a
href="https://tinyurl.com/hnn-workshop-25">Workshop page</a>, then do
the following (you may have already obtained this number in the initial
install):
<ol type="i">
<li>run the following command in a Terminal:
<code>python -c "import psutil ; print(psutil.cpu_count(logical=False)-1)"</code></li>
<li>read the output number,</li>
<li>put that number in the <code>Cores</code> textbox of the GUI. This
will greatly increase your simulation speed.</li>
</ol></li>
</ol>
<section class="stylefig">
<h3>Figure 4</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/core-gui-alpha-initial-setup.png" /></p>
</section>
<p><a id="toc-4"></a></p>
<h2>4. Simulating Rhythmic Proximal Inputs: Alpha Only</h2>
<h3>4.1 Load and view our proximal inputs</h3>
<p>As described in <a href="#toc-1">Section 1. Background</a>,
low-frequency alpha and beta rhythms can be simulated by a combination
of rhythmic subthreshold proximal and distal ~10Hz inputs. Here, we
begin by describing the impact of <strong>only proximal inputs</strong>.
An initial parameter set that will simulate the effect of ~10 Hz
subthreshold proximal drive is provided in the file
<code>OnlyRhythmicProx.json</code>, which you downloaded in <a
href="#toc-2">Section 2</a></p>
<p>The default cortical column network for this simulation, and HNN as a
whole, is described in the <a
href="../01_getting_started/template_model.html">Template Model
section</a>. Several of the network parameters can be adjusted via the
GUI in the <code>Network</code> tab (e.g. local excitatory and
inhibitory connection strengths), but we will <strong>not</strong> be
changing them in this tutorial. Instead, we will <strong>only</strong>
be changing parameters in the <code>Simulation</code>,
<code>External drives</code>, and <code>Visualization</code> tabs.</p>
<p>To load the initial parameter set, navigate to the GUI and do the
following steps (these are illustrated below in <a
href="#figure-5">Figure 5</a>):</p>
<ol type="1">
<li>Click the tab labeled: <code>External drives</code>.</li>
<li>Inside of the inside of the tab, click the button
<code>Load external drives (0)</code>, then select the file
<code>OnlyRhythmicProx.json</code>, which you downloaded previously in
<a href="#toc-2">Section 2</a>.</li>
<li>To view the parameters that “activate” the network via rhythmic
proximal input, click the dropdown menu labeled
<code>bursty1 (proximal)</code>.</li>
</ol>
<div class="stylefig">
<table>
<h3>Figure 5</h3>
<tr>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/initial-external-drives-look-01.png" />
</td>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/initial-external-drives-look-02.png" />
</td>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/initial-external-drives-look-03.png" />
</td>
</tr>
</table>
</div>
<p>You should now be able to scroll and see the values of adjustable
parameters, displayed as in the dialog boxes below in <a
href="#figure-6">Figure 6</a>. There are 4 sections, which we will
describe in greater detail below. For now, we will <strong>not</strong>
change any of these parameters, but instead only describe them.</p>
<div class="stylefig">
<table>
<h3>Figure 6</h3>
<tr>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image08.png" />
</td>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image09.png" />
</td>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image10.png" />
</td>
</tr>
</table>
</div>
<ol type="1">
<li><strong>bursty1 (proximal)</strong>: The first section deals with
all properties of the drive not included in other sections, including
the timing settings, statistical properties, number of spikes per burst,
number of virtual “drive cells”, and pseudo-random number generation
seed. This is an important section which we will return to
frequently.</li>
<li><strong>AMPA weights</strong>: This section governs the excitatory
AMPAergic post-synaptic conductances from the drive onto the excitatory
Layer 5 and Layer 2/3 Pyramidal cells, and onto inhibitory Layer 5 and
Layer 2/3 Basket cells. All synapse conductances are given in units of
microSiemens, or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>μ</mi><mi>S</mi></mrow><annotation encoding="application/x-tex">\mu S</annotation></semantics></math>.</li>
<li><strong>NMDA weights</strong>: which is analagous to the
<strong>AMPA weights</strong> section, but for the NMDA synapses.</li>
<li><strong>Synaptic delays</strong>: This section governs the synaptic
delays from the drive to all cell types.</li>
</ol>
<p>Rhythmic proximal input occurs through stochastic, presynaptic bursts
of action potentials from a population of bursting cells onto
postsynaptic neurons of the modelled network (see <a
href="#figure-3">Figure 3</a>). All drive stochasticity is controlled by
parameters in the first section of these four. The spike train start
time for each bursting cell is sampled from a normal distribution with
mean <code>Start time (ms)</code> and standard deviation
<code>Start time dev (ms)</code>. The inter-burst intervals, or time
between bursts, for each bursting cell are sampled from a normal
distribution of mean
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mn>1</mn><mrow><mi>B</mi><mi>u</mi><mi>r</mi><mi>s</mi><mi>t</mi><mi>R</mi><mi>a</mi><mi>t</mi><mi>e</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>H</mi><mi>z</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><annotation encoding="application/x-tex">\frac{1}{BurstRate (Hz)}</annotation></semantics></math>
(e.g., a <code>Burst rate (Hz)</code> of 10 Hz corresponds to an
inter-burst interval of 0.1 second or 100 ms) and standard deviation
<code>Burst std dev (Hz)</code> (see <a href="#figure-3">Figure 3</a>).
Also note that the number of spikes per burst unit is set with
<code>No. Spikes</code> and the final stop time for the entire
population of rhythmic proximal inputs is set with
<code>Stop time (ms)</code>.</p>
<p>For more discussion on the rhythmic drive model itself, see <a
href="../03_model_assumptions/evoked_and_rhythmic_driving_inputs.html">Model
Assumptions: 2.5 Evoked and Rhytymic Driving Inputs</a>.</p>
<p><a id="toc-4-2"></a></p>
<h3>4.2 Run the simulation and visualize the net current dipole</h3>
<p>To run this simulation, navigate to the main GUI window and
click:</p>
<pre><code>Run</code></pre>
<p>This simulation runs for 700 ms of simulation time, so will take
longer to run than the ERP simulations in the Morning session. Each of
the individual simulations in this tutorial will take approximately 4
minutes to run using the Google CoLab notebook. Once completed, you will
see output similar to that shown below.</p>
<section class="stylefig">
<h3>Figure 7</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/OnlyRhythmicProx-initial.png" /></p>
</section>
<p>Concerning stochasticity: As shown in the red histogram in the top
panel of <a href="#figure-7">Figure 7</a> above, with this parameter
set, a burst of proximal input spikes is provided to the network at a
rate of ~10 Hz (i.e., every 100 ms). Due to the stochastic nature of the
inputs (controlled by the <code>Start time dev (ms)</code> and
<code>Burst std dev (Hz)</code> parameters), there is some variability
in the histogram of proximal input times, and the exact histogram
pattern may look different on your simulation. Note that a decrease in
the <code>Burst std dev (Hz)</code> would create shorter duration bursts
(i.e., more synchronous bursts); this will be explored further in <a
href="#toc-6-2">Section 6.2</a> below.</p>
<p>The main point with this simulation is that ~10 Hz bursts of proximal
drive induce current flow <strong>up</strong> the pyramidal neuron
dendrites. This upward current flow increases the dipole signal above
the 0 nAm baseline (making it positive), before the dipole relaxes back
to zero approximately every 100 ms. This is observed in the blue current
dipole waveform in the GUI window. See <a href="#figure-3">Figure 3</a>
and <a
href="https://dylansdaniels.github.io/website_redesign/tests/workshop.html#figure-a">Figure
A on the Workshop page</a> for illustration of the relationship between
proximal drive input and the flow of current.</p>
<p><a id="toc-4-3"></a></p>
<h3>4.3 Visualize the spectrogram of the net current dipole</h3>
<p>To view the time-frequency spectrogram for this waveform (shown below
in <a href="#figure-8">Figure 8</a>), do the following steps:</p>
<ol type="1">
<li>Click on the <code>Visualization</code> tab.</li>
<li>Click on the <code>Layout template</code> dropdown menu and select
<code>Drive-Dipole-Spectrogram (3x1)</code>.</li>
<li>Click on the <code>Dataset</code> dropdown menu and select the most
recent simulation name, which is <code>OnlyRhythmicProx</code> (or
whatever you set the <code>Name</code> to previously).</li>
<li>Finally, click the <code>Make Figure</code> button.</li>
</ol>
<section class="stylefig">
<h3>Figure 8</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/OnlyRhythmicProx_Spect.png" /></p>
</section>
<p>The bottom panel of <a href="#figure-8">Figure 8</a> shows the
corresponding time-frequency spectrogram for this waveform, which
exhibits a high-power continuous 10 Hz signal.</p>
<p>Importantly, in this example, the strength of the proximal input
spikes were titrated to be subthreshold. In other words, our simulated
cortical cells do <strong>not</strong> spike in this instance. This is
because we assume that macroscale oscillations are generated primarily
by subthreshold current flow across large populations of synchronous
pyramidal neurons (see <a href="#toc-1">Section 1. Background</a> above
for details). We will illustrate the relationship between spiking and
the signal later, in <a href="#toc-6-3">Section 6.3</a> (see also <a
href="../05_erps/erps_in_gui.html">our ERP tutorial</a>).</p>
<p>This exploration with a proximal drive is only useful in
understanding how subthreshold rhythmic inputs impact the current dipole
produced by the circuit. However, several features of the waveform and
spectrogram of the signal do <em>not</em> match the recorded data shown
in <a href="#figure-1">Figure 1</a> and <a href="#figure-2">Figure
2</a>. Next, we explore the impact of rhythmic <em>distal</em> inputs
only (<a href="#toc-5">Section 5</a>), and then a combination of the two
(<a href="#toc-6">Section 6</a>).</p>
<p><a id="toc-5"></a></p>
<h2>5. Simulation Rhythmic Distal Inputs: Alpha only</h2>
<h3>5.1 Load/view parameters to define the network structure &amp; to
“activate” the network</h3>
<p>We will next use a param file that generates bursts of only
<strong>distal</strong> inputs provided at the alpha frequency (10 Hz),
file <code>OnlyRhythmicDist.json</code>. Do the folowing steps:</p>
<ol type="1">
<li>Click back to the <code>Simulation</code> tab.</li>
<li>Change the <code>Name</code> of the simulation to
<code>OnlyRhythmicDist</code> (or whatever you prefer).</li>
<li>Click the tab labeled: <code>External drives</code>.</li>
<li>Inside of the inside of the tab, click the button
<code>Load external drives (0)</code>, then select the file
<code>OnlyRhythmicDist.json</code>, which you downloaded previously in
<a href="#toc-2">Section 2</a>.</li>
<li>To view the parameters that “activate” the network via rhythmic
distal input, click the dropdown menu labeled
<code>bursty2 (distal)</code>.</li>
</ol>
<p>You should see the values of adjustable parameters displayed as in
the dialog boxes below in <a href="#figure-9">Figure 9</a>. Notice that
these parameters are the same as those regulating the proximal drive in
<a href="#toc-4">Section 4</a>, except for the synaptic delays. In this
case, the parameters define bursts of synaptic inputs that drive the
network in a <strong>distal</strong> projection pattern, which are
illustrated in <a href="#figure-3">Figure 3</a> and <a
href="https://dylansdaniels.github.io/website_redesign/tests/workshop.html#figure-a">Figure
A on the Workshop page</a>.</p>
<div class="stylefig">
<table>
<h3>Figure 9</h3>
<tr>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image15.png" />
</td>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image16.png" />
</td>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image17.png" />
</td>
</tr>
</table>
</div>
<p>To run this simulation, navigate to the main GUI window and
click:</p>
<pre><code>Start Simulation</code></pre>
<p>Once completed, you will see output similar to that shown below.</p>
<section class="stylefig">
<h3>Figure 10</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/OnlyRhythmicDist.png" /></p>
</section>
<p>As shown in the green histogram in the top panel of the HNN GUI
above, with this parameter set, a burst of distal input spikes is
provided to the network ~10 Hz (i.e., every 100 ms). As discussed
previously, due to the stochastic nature of the inputs (controlled by
the <code>Start time dev (ms)</code> and <code>Burst std dev (Hz)</code>
parameters), there is some variability in the histogram of proximal
input times.</p>
<p>The ~10 Hz bursts of distal input induces current flow
<strong>down</strong> the pyramidal neuron dendrites, decreasing the
signal below the 0 nAm baseline (making it negative), followed by the
signal relaxing back to zero, approximately every 100 ms. This is
observed in the blue current dipole waveform in the GUI window. Once
again, see <a href="#figure-3">Figure 3</a> above and <a
href="https://dylansdaniels.github.io/website_redesign/tests/workshop.html#figure-a">Figure
A on the Workshop page</a> for the relationship between distal inputs
and direction of signal propagation.</p>
<p>Once again we will create time-frequency spectrogram for this
waveform:</p>
<ol type="1">
<li>Click on the <code>Visualization</code> tab.</li>
<li>Click on the <code>Layout template</code> dropdown menu and select
<code>Drive-Dipole-Spectrogram (3x1)</code>.</li>
<li>Click on the <code>Dataset</code> dropdown menu and select the
<strong>most recent</strong> simulation name, which is
<code>OnlyRhythmicDist</code> (or whatever you set the <code>Name</code>
to previously).</li>
<li>Finally, click the <code>Make Figure</code> button.</li>
</ol>
<section class="stylefig">
<h3>Figure 11</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/OnlyRhythmicDist_Spect.png" /></p>
</section>
<p>The bottom panel shows the corresponding time-frequency spectrogram
for this waveform that exhibits a high power continuous 10 Hz signal.
Importantly, in this example, the strength of the distal input was also
titrated to be subthreshold (i.e., cells do not spike). Again, ee will
illustrate the relationship between spiking and the signal later, in <a
href="#toc-6-3">Section 6.3</a> (see also <a
href="../05_erps/erps_in_gui.html">our ERP tutorial</a>).</p>
<p>While instructional, this simulation also does not produce waveform
and spectral features that match the experimental data in <a
href="#figure-1">Figure 1</a> and <a href="#figure-2">Figure 2</a>. In
the next section (<a href="#toc-6">Section 6</a>), we describe how
combining <strong>both</strong> the 10 Hz proximal and distal drives can
produce an oscillation with many characteristic features of the
spontaneous SI signal <span class="citation"
data-cites="jones_quantitative_2009">(<a
href="#ref-jones_quantitative_2009" role="doc-biblioref">Stephanie R.
Jones et al. 2009</a>)</span>.</p>
<p><a id="toc-6"></a></p>
<h2>6. Simulating Combined Rhythmic Proximal and Distal Inputs:
Alpha/Beta Complex</h2>
<p><a id="toc-6-1"></a></p>
<h3>6.1 Load/view parameters to define the network structure &amp; to
“activate” the network.</h3>
<p>In this example, we provide a parameter set file
<code>AlphaAndBeta.json</code> that produces many of the waveform and
spectral features observed in our SI data (<a href="#figure-2">Figure
2</a>).</p>
<ol type="1">
<li>Click back to the <code>Simulation</code> tab.</li>
<li>Change the <code>Name</code> of the simulation to
<code>AlphaAndBeta</code></li>
<li>Click the tab labeled: <code>External drives</code>.</li>
<li>Inside of the inside of the tab, click the button
<code>Load external drives (0)</code>, then select the file
<code>AlphaAndBeta.json</code>, which you downloaded previously in <a
href="#toc-2">Section 2</a>.</li>
<li>To view the parameters that “activate” the network via rhythmic
distal input, click the dropdown menus labeled
<code>bursty1 (proximal)</code> and <code>bursty2 (distal)</code>.</li>
</ol>
<p>You should see the values displayed in the dialogue boxes below.</p>
<section class="stylefig">
<h3>Figure 12</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image20.png" /></p>
</section>
<p>In this simulation, all external drive parameters the same as they
were for each drive in the previous simulations (except for the random
<code>Seed</code>). The only significant difference is that
<strong>both</strong> distal and proximal drives are included.</p>
<p>Importantly, the <code>Start time (ms)</code> values for both inputs
are set to 50.0 ms, meaning that the proximal and distal input bursts
will arrive nearly synchronously to the network on each cycle of the 10
Hz input. However, due to the stochasticity in the parameters
(<code>Start time dev (ms)</code> and <code>Burst std dev (Hz)</code>),
sometimes the bursts will arrive together and sometimes there will be a
slight delay. As will be described further below, this stochasticity
will create intermittent alpha and beta events.</p>
<p><a id="toc-6-2"></a></p>
<h3>6.2 Run the simulation and visualize net current dipole</h3>
<p>To run this simulation, navigate to the main GUI window by clicking
the <code>Simulation</code> tab and then click:</p>
<pre><code>Run</code></pre>
<p>Once completed, you will see output similar to that shown below.</p>
<section class="stylefig">
<h3>Figure 13</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/AlphaAndBeta.png" /></p>
</section>
<p>Follow the steps in the previous sections (such as <a
href="#toc-4-3">Section 4.3</a>) to create a time-frequency spectrogram
for this waveform, and remember to set <code>Dataset</code> to the most
recent simulation, <code>AlphaAndBeta</code>. The output will look
similar to the figure below:</p>
<section class="stylefig">
<h3>Figure 14</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/AlphaAndBeta_Spect.png" /></p>
</section>
<p>As shown in the green and red histogram in the top panel of the GUI
Figures above, with this parameter set, bursts of both proximal and
distal input spikes are provided to the network ~10 Hz (i.e., every 100
ms). Due to the stochastic nature of the inputs, there is some
variability in the timing and duration of the input bursts: sometimes
they arrive at the same time, and sometimes there is a slight offset
between them. As a result, intermittent, transient alpha and beta events
emerge in the time-frequency spectrogram.</p>
<p>Alpha events are produced when the inputs occur slightly out of phase
and current flow is pushed alternately up and down the dendrites for ~50
ms duration each; the current flow of either burst input type does not
interfere with the other. Beta events, in contrast, occur when the burst
inputs arrive more synchronously; this causes upward current flow to be
disrupted by downward current flow for ~50 ms, effectively cutting the
oscillation period in half. Therefore, the relative expression of alpha
versus beta can be controlled by the relative delay between the inputs
and their relative burst strengths.</p>
<p>The current dipole signal of this simulation, shown in the above
figure, oscillates above and below 0 nAm, which qualitatively matches
the experimental data (see <a href="#figure-1">Figure 1</a> and <a
href="#figure-2">Figure 2</a> in <a href="#toc-1">Section 1.
Background</a>). This is different than the proximal- or distal-only
simulations in prior sections, since the current in the pyramidal
neurons is pushed both upward and downward in this simulation.
Additionally, this simulation reproduces the transient nature of the
alpha and beta activity and several other features of the waveform and
spectrogram can be quantified to show close agreement between model and
experimental results (see <a href="#figure-2">Figure 2</a> above, and
<span class="citation" data-cites="jones_quantitative_2009">(<a
href="#ref-jones_quantitative_2009" role="doc-biblioref">Stephanie R.
Jones et al. 2009</a>)</span> for further details).</p>
<p>We note that here, we do not directly compare the spontaneous current
dipole waveform to recorded data, as is done in the <a
href="../05_erps/erps_in_gui.html">ERP tutorial</a> with a root mean
squared error. This is due to the fact that the spontaneous SI signal we
are simulating is not time-locked to alpha or beta events on any given
trial, and the stochastic nature of the driving inputs causes
variability in the timing of the alpha or beta activity, making it
difficult to align recorded data and simulated results.</p>
<!-- However, a direct comparison can be made between time averaged recorded and simulated signals by comparing power spectral density waveforms. We will detail this further below (see [Section 8](#toc-8) below). -->
<p><a id="toc-6-3"></a></p>
<h3>6.3 Viewing network spiking activity</h3>
<p>Importantly, in all the simulations of this tutorial so far, the
strength of the proximal and distal inputs were titrated to be
<strong>subthreshold</strong>, meaning that they do not cause our
simulated cortical cells to spike. This is based on our assumption that
macroscale oscillations are generated primarily by subthreshold current
flow across large populations of synchronous pyramidal neurons (see <a
href="#toc-1">Section 1. Background</a> for references). We can verify
the subthreshold nature of the inputs by viewing the spiking activity in
the network. Do the following steps to see our spiking rastergram:</p>
<ol type="1">
<li>Click on the <code>Visualization</code> tab.</li>
<li>Click on the <code>Layout template</code> dropdown menu and select
<code>Drive-Spikes (2x1)</code>.</li>
<li>Click on the <code>Dataset</code> dropdown menu and select the
<strong>most recent</strong> simulation name, which is
<code>AlphaAndBeta</code>.</li>
<li>Finally, click the <code>Make Figure</code> button.</li>
</ol>
<section class="stylefig">
<h3>Figure 20</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/AlphaAndBeta_Spikes.png" /></p>
</section>
<p>In this window, the rhythmic distal (green/top) and proximal
(red/middle) input-burst-histograms are shown above the spiking activity
in each population of cells (bottom panel). In this case, the alpha and
beta events are indeed produced through subthreshold processes, and
<em>there is no spiking produced in any cell in the network</em>
(i.e. there are no dots present in the bottom raster plot)!</p>
<h3>6.4 Simulating and averaging multiple trials with jittered start
times creates the impression of continuous oscillations</h3>
<p>As described in <a href="#toc-1">Section 1. Background</a> above, our
simulation goal was to study the mechanisms that reproduce features of
spontaneous alpha and beta rhythms observed in un-averaged data. These
features include the fact that alpha and beta components are transient
and intermittent (<a href="#figure-1">Figure 1</a>, right panel). Each
tutorial section up to this point was based on simulating un-averaged
data.</p>
<p>Here, we will show that, depending on the stochastic nature of the
proximal and distal rhythmic inputs, alpha and beta activity on
different simulation “trial” may be jittered, creating the impression of
continuous oscillations. We will describe how to run and average
multiple simulation “trials” (700 ms epochs of spontaneous activity),
and change the stochasticity by changing the standard deviation of the
start times of the drives (<code>Start time dev (ms)</code>). This is
akin to simulating induced rhythms rather than time-locked evoked
rhythms. In the averaged spectrogram across trials, the alpha and beta
events will accumulate without cancellation (due to the fact that
spectrogram values are purely positive), creating the impression of a
continuous oscillation, such as in <a href="#figure-1">Figure 1</a>.</p>
<ol type="1">
<li>Click back to the <code>Simulation</code> tab.</li>
<li>Change the <code>Name</code> of the simulation to
<code>AlphaAndBetaJitter50</code></li>
<li>Click the tab labeled: <code>External drives</code>.</li>
<li>Inside of the inside of the tab, click the button
<code>Load external drives (0)</code>, then select the file
<code>AlphaAndBetaJitter50.json</code>, which you downloaded previously
in <a href="#toc-2">Section 2</a>.</li>
<li>To view the parameters that “activate” the network via rhythmic
distal input, click the dropdown menus labeled
<code>bursty1 (proximal)</code> and <code>bursty2 (distal)</code>.</li>
</ol>
<p>You should see the values displayed in the dialogue boxes below.</p>
<div class="stylefig">
<table>
<h3>Figure 15</h3>
<tr>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image21.png" />
</td>
<td>
<img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image22.png" />
</td>
</tr>
</table>
</div>
<p>For this simulation, the only difference in the parameters from that
of the prior <code>AlphaAndBeta.json</code> simulation is that
<code>Start time dev (ms)</code> for both drives has been increased from
0 to 50 ms. Both drives will still input at a 10 Hz rate, but the distal
versus proximal inputs are less likely to occur at the same time.</p>
<p>Finally, we need to change one more parameter before we run the
simulations: <code>Trials</code>. If we increase <code>Trials</code>
above 1, this will cause HNN to run that number of consecutive
simulations, each with different randomized initial conditions for the
drives. After all trial simulations are complete, the averaged data will
automatically be computed and plotted. You will then be able to do
further plots using the averaged signal. Note that increasing the number
of trials will correspondingly increase the amount of time needed to run
the simulations; e.g. if you are using the Google Colab notebook,
running 3 trials may take approximately 12 minutes if a single
simulation takes 4 minutes. (We do support parallelization of simulation
across trials, but this is beyond the scope of this tutorial; see <a
href="https://jonescompneurolab.github.io/hnn-core/stable/install.html#parallelism-joblib-installation">our
Joblib instructions here</a>.)</p>
<p>Do the following:</p>
<ol type="1">
<li>Click back to the <code>Simulation</code> tab.</li>
<li>Change the <code>Trials</code> to <code>3</code>.</li>
<li>Click <code>Run</code>.</li>
</ol>
<p>Once completed, we recommend you immediately plot the spectrogram of
these simulations, using the instructions before in <a
href="#toc-4-3">Section 4.3</a> and selecting the new dataset for
<code>AlphaAndBetaJitter50</code>. You should get a plot that looks like
below:</p>
<section class="stylefig">
<h3>Figure 16</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/AlphaAndBetaJitter50_Spect.png" /></p>
</section>
<p>Notice that the input histograms for distal (green) and proximal
(red) input accumulated across the 10 trials now show little rhythmicity
due to the jitter in the rhythmic input start times across trials
(<code>Start time dev (ms)</code> = 50), in addition to jitter due to
the inherent burst variance (<code>Burst std dev (Hz)</code> = 20).
However, if we were to visualize histograms on each individual trial,
they would show the 10 Hz and 20 Hz (alpha and beta) rhythmicity,
similar to <a href="#figure-14">Figure 14</a>.</p>
<!-- It is also difficult to visualize rhythmicity in any of the overlaid dipole waveforms. However, on each trial, alpha and beta rhythmicity is present, and even more continuous bands of alpha and beta activity are observed (compare to averaged data in [Figure 1](#figure-1) left panel; n=100 trials) when the spectrograms from individual trials are averaged. Running more trials will further increase the continuous nature of alpha and beta activity across time. -->
<p>This averaged simulation data exhibits oscillations that appear more
continuous than in the single examples before, like <a
href="#figure-14">Figure 14</a>. Additionally, we also see relatively
more alpha, rather than beta, in this averaged simulation data. This is
consistent with our earlier explanation in <a href="#toc-6-2">Section
6.2</a>: less synchrony between the inputs of the drives implies there
is less chance of the signals going both up and down the dendrites
simultaneously, leading to relatively more alpha than beta.</p>
<!-- Notice that the input histograms for distal (green) and proximal (red) input accumulated across the 10 trials, now have higher values than before (up to ~20 compared to 5 in [Section 4.2](#toc-4-2)) and the burst inputs are slightly broader on each cycle, since these histograms represent the accumulated activity from 10 simulations, where the standard deviation in the Burst duration across trials is 20 ms. Approximately 10 Hz rhythmicity in the timing of the distal and proximal inputs can be clearly visualized (note also the symmetric profile of the histograms). However, on any individual trial, the coincidence of inputs leading to alpha or beta events displays some variability due to the stochastic parameter value (Burst stdev=20 ms). This is observed in the dipole waveforms shown for each trial (example shown below). -->
<!-- In the next simulation, we will jitter the start times of rhythmic inputs across trials with the Start time stdev, in addition to a non-zero Burst stdev. This will add additional variability to the timing of the transient alpha and beta events on each trial, and hence produce even more continuous bands of activity in the averaged spectrogram. -->
<!-- First, navigate to the `External drives` tab and open the `bursty1 (proximal)` and `bursty2 (distal)` dropdown menus. Change the start time stdev from 0 ms to 50 ms in the timing tabs. The dialog boxes should now look as follows. -->
<h3>6.5 Exercises for further exploration</h3>
<p>Try decreasing or increasing the number of trials in the above
simulations to see how these changes impact the continuity of alpha/beta
power over time.
<!-- View some of the individual spectrograms to see that alpha/beta are maintained on individual trials. --></p>
<p><a id="toc-7"></a></p>
<!-- ## 7. Calculating and Viewing Power Spectral Density (PSD) -->
<!-- HNN provides a feature to calculate and view the power spectral density (PSD) of the simulated signal and imported data (Note: the PSD is calculated as the time average of the spectrogram, in the simulation examples). -->
<!-- To calculate and view the PSD, navigate to the `Visualization` tab, click on the `Layout template` dropdown, and select `PSD Layers (3x1)` -->
<!-- You should see something similar to the following window. -->
<!-- <div class="stylefig"> -->
<!-- ### Figure 21 -->
<!-- ![](https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/AlphaAndBetaJitter50_3trials_PSD.png) -->
<!-- </div> -->
<!-- The PSD Viewer window shows the net current dipole (bottom panel) and contribution from each layer in the network separately (top panels). This example was run using the parameter set described in [Section 6](#toc-6). PSD from the simulation shows a strong peak in the alpha (~10 Hz) band, with a lower peak power in beta band (~20 Hz). -->
<p><a id="toc-8"></a></p>
<!-- Commenting this section out until the issues with carefully loading alpha data from the "S1_ongoing.txt" file are resolved, see https://github.com/jonescompneurolab/hnn-core/issues/617
-->
<!-- ## 8. Comparing model output and recorded data -->
<!-- TODO Work in progress! -->
<p><a id="toc-9"></a></p>
<!-- ## 9. Adjusting parameters -->
<!-- ## 8. Adjusting parameters -->
<h2>7. Adjusting parameters</h2>
<p>Parameter adjustments will be key to developing and testing
hypotheses on the circuit origin of your own low-frequency rhythmic
data. HNN is designed so that many of the parameters in the model can be
adjusted from the GUI.</p>
<p>Here, we’ll walk through examples of how to adjust several “Rhythmic
Proximal/Distal Input” parameters to investigate how they impact the
alpha and beta rhythms described above. We end with some suggested
exercises for further exploration.</p>
<!-- ### 9.1 Changing the strength (post-synaptic conductance) and synchrony of the distal drive increases beta activity -->
<!-- ### 8.1 Changing the strength (post-synaptic conductance) and synchrony of the distal drive increases beta activity -->
<h3>7.1 Changing the strength (post-synaptic conductance) and synchrony
of the distal drive increases beta activity</h3>
<p>We described above (<a href="#toc-6-2">Section 6.2</a>) how the
timing of proximal and distal inputs can lead to either alpha events
(when the bursts arrive to the local network out of phase) or beta
events (when the bursts arrive in phase).</p>
<p>We have also found that another factor that contributes to the
prevalence of beta activity is the strengthened synchrony of the distal
inputs. Beta activity is increased with stronger and more synchronous
subthreshold drive, where the beta frequency is set by the duration of
the driving bursts (~50ms) (<span class="citation"
data-cites="jones_quantitative_2009">(<a
href="#ref-jones_quantitative_2009" role="doc-biblioref">Stephanie R.
Jones et al. 2009</a>)</span> and <span class="citation"
data-cites="sherman_neural_2016">(<a href="#ref-sherman_neural_2016"
role="doc-biblioref">Sherman et al. 2016</a>)</span>). The strength is
controlled by the postsynaptic conductance, and the synchrony is
controlled by the <code>Burst std dev (Hz)</code>. We will demonstrate
this here. Do the following:</p>
<ol type="1">
<li>Click back to the <code>Simulation</code> tab.</li>
<li>Change the <code>Name</code> of the simulation to
<code>AlphaAndBetaIncrBeta</code></li>
<li>Change <code>Trials</code> back to 1.</li>
<li>Click the tab labeled: <code>External drives</code>.</li>
<li>Inside of the inside of the tab, click the button
<code>Load external drives (0)</code>, then select the previously-used
file <code>AlphaAndBeta.json</code>.</li>
<li>Click the dropdown menu labeled <code>bursty2 (distal)</code>. (NOT
<code>bursty1 (proximal)</code>!)</li>
<li>Decrease <code>Burst std dev (Hz)</code> from <code>20</code> to
<code>10</code>.</li>
<li>Scroll down, and increase the <code>AMPA weights</code> to both
<code>L5_pyramidal</code> and <code>L2_pyramidal</code> from
<code>0.000054</code> to <code>0.00006</code></li>
</ol>
<p>Both of these changes will cause the distal input burst to push a
greater amount of current flow down the pyramidal neuron dendrites. Your
<code>bursty2 (distal)</code> drive parameters should look like the
following:</p>
<section class="stylefig">
<h3>Figure 17</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image28.png" /></p>
</section>
<ol type="1">
<li>Run the simulation by clicking <code>Run</code>.</li>
<li>After the simulation has run, follow the steps from <a
href="#toc-4-3">Section 4.3</a> to create a time-frequency spectrogram,
making sure to set the <code>Dataset</code> to the latest simulation,
<code>AlphaAndBetaIncrBeta</code>.</li>
</ol>
<p>Once completed, you will see output in the GUI similar to that shown
below:</p>
<section class="stylefig">
<h3>Figure 18</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/AlphaAndBetaIncrBeta.png" /></p>
</section>
<section class="stylefig">
<h3>Figure 19</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/AlphaAndBetaIncrBeta_Spect.png" /></p>
</section>
<p>First, notice that the histogram profile of the distal input bursts
(green) are narrower, corresponding to more synchronous input than in
the original <code>AlphaAndBeta</code> simulation (<a
href="#figure-14">Figure 14</a>). Second, notice that the waveform of
the oscillation is also different, with a sharper downward (negative)
deflecting signal, due to to the stronger distal input. These
deflections lead to increased ~20 Hz beta activity relative to 10 Hz
alpha activity, as seen in the corresponding spectrogram (compare to <a
href="#figure-14">Figure 14</a>). The 20 Hz frequency is set by the
duration of the downward current flow, which here is approximately 50 ms
(see <span class="citation" data-cites="sherman_neural_2016">(<a
href="#ref-sherman_neural_2016" role="doc-biblioref">Sherman et al.
2016</a>)</span> for further details).</p>
<!-- ### 9.1.1 Exercise for further exploration
<!-- ### 8.1.1 Exercise for further exploration -->
<h3>7.1.1 Exercise for further exploration</h3>
<p>Try changing the frequency of the rhythmic distal drive from 10 Hz to
20 Hz. Try other frequencies for the proximal and distal rhythmic drive.
How do the rhythms change? See how further changes in the
<code>Burst std dev (Hz)</code> affect the rhythms expressed.</p>
<!-- ### 9.2 Increasing the delay between the proximal and distal inputs to anti-phase (50 ms delay) creates continuous alpha oscillations without beta activity -->
<!-- ### 8.2 Increasing the delay between the proximal and distal inputs to anti-phase (50 ms delay) creates continuous alpha oscillations without beta activity -->
<h3>7.2 Increasing the delay between the proximal and distal inputs to
anti-phase creates continuous alpha oscillations without beta
activity</h3>
<p>We mentioned above that, in addition to parameters controlling the
strength and synchrony of the distal drive, the relative timing of
proximal and distal inputs is an important factor in determining
relative alpha and beta expression in the model. Here we will
demonstrate that out-of-phase, 10 Hz burst inputs can produce continuous
alpha activity <em>without</em> any beta events. Do the following:</p>
<ol type="1">
<li>Click back to the <code>Simulation</code> tab.</li>
<li>Change the <code>Name</code> of the simulation to
<code>AlphaOnly</code></li>
<li>Click the tab labeled: <code>External drives</code>.</li>
<li>Inside of the inside of the tab, click the button
<code>Load external drives (0)</code>, then select the previously-used
file <code>AlphaAndBeta.json</code>.</li>
<li>Click the dropdown menu labeled <code>bursty1 (proximal)</code>.
(NOT <code>bursty2 (distal)</code>!)</li>
<li>Increase <code>Start time (ms)</code> from <code>50</code> to
<code>100</code>.</li>
</ol>
<p>Note that both the proximal and distal input frequency are set to 10
Hz (bursts of activity every ~100 ms). Since the proximal input start
time is 50 ms and the the distal input start time is 100 ms, the input
will, on average, arrive to the network a half-cycle out of phase (i.e.,
in antiphase, every 50 ms).</p>
<ol type="1">
<li>Run the simulation by clicking <code>Run</code>.</li>
<li>After the simulation has run, follow the steps from <a
href="#toc-4-3">Section 4.3</a> to create a time-frequency spectrogram,
making sure to set the <code>Dataset</code> to the latest simulation,
<code>AlphaOnly</code>.</li>
</ol>
<p>Once completed, you will see output similar to that shown below.</p>
<section class="stylefig">
<h3>Figure 20</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/AlphaOnly.png" /></p>
</section>
<section class="stylefig">
<h3>Figure 21</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/AlphaOnly_Spect.png" /></p>
</section>
<p>Notice that the histogram profile of the proximal (red) and distal
(green) input bursts are generally ½ cycle out-of-phase (antiphase).
This rhythmic alteration of proximal, followed by distal, drive induces
alternating subthreshold current flow up and down the pyramidal neuron
dendrites. This creates a continuous alpha oscillation in the current
dipole waveform that oscillates around 0 nAm. The period of the
oscillation is set by the duration of each burst (~50 ms, controlled in
part by <code>Burst std dev (Hz)</code>) and the 50 ms delay between the
inputs on each cycle (due to different start times). The corresponding
spectrogram shows continuous, nearly-pure alpha activity, in contrast to
the intermittent alpha and beta of <a href="#figure-14">Figure 14</a> .
This type of strong alpha activity is similar to what might be observed
over occipital cortex during eyes-closed conditions.</p>
<!-- ### 9.2.1 Exercise for further exploration -->
<!-- ### 8.2.1 Exercise for further exploration -->
<h3>7.2.1 Exercise for further exploration</h3>
<p>Try changing the delay between the proximal and distal drive by
varying amounts. What happens to the rhythm expressed?</p>
<p>Can you create a simulation where other frequencies are expressed?
How is it created? Are the cells spiking or subthreshold?</p>
<!-- ### 9.3 Increasing the strength (post-synaptic conductance) of the distal drive further creates high frequency responses due to induced spiking activity -->
<!-- ### 8.3 Increasing the strength (post-synaptic conductance) of the distal drive further creates high frequency responses due to induced spiking activity -->
<h3>7.3 Increasing the strength of the distal drive further creates
high-frequency responses due to induced spiking activity</h3>
<p>Recall that in the above simulations, the strength of the rhythmic
proximal and distal inputs were chosen so that the simulated cells
remained subthreshold (no spiking). We will now demonstrate what happens
if we increase the strength of the inputs far enough to induce spikes.
Instead of simulating subthreshold alpha/beta events, we will see that
the dipole signals become dominated by higher-frequency events created
by spiking activity. We note that the produced waveforms of activity
are, to our knowledge, <strong>not typically observed in MEG or EEG
data</strong>, supporting the notion that alpha/beta rhythms are created
through subthreshold processes. Do the following:</p>
<ol type="1">
<li>Click back to the <code>Simulation</code> tab.</li>
<li>Change the <code>Name</code> of the simulation to
<code>HighFreqSpiking</code></li>
<li>Increase the <code>Max Spectral Frequency (Hz)</code> from
<code>40</code> to <code>120</code></li>
<li>Click the tab labeled: <code>External drives</code>.</li>
<li>Inside of the inside of the tab, click the button
<code>Load external drives (0)</code>, then select the previously-used
file <code>AlphaAndBeta.json</code>.</li>
<li>Click the dropdown menu labeled <code>bursty2 (distal)</code>. (NOT
<code>bursty1 (proximal)</code>!)</li>
<li>Scroll down, and increase the <code>AMPA weights</code> to both
<code>L5_pyramidal</code> and <code>L2_pyramidal</code> from
<code>0.000054</code> to <code>0.0004</code> (notice the zeros!)</li>
<li>Click <code>Run</code>.</li>
</ol>
<p>Your <code>bursty2 (distal)</code> drive parameters should look like
the following:</p>
<section class="stylefig">
<h3>Figure 22</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/image25.png" /></p>
</section>
<p>Your simulation output should look like the following:</p>
<section class="stylefig">
<h3>Figure 23</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/HighFreqSpiking.png" /></p>
</section>
<p>Because we have greatly increased postsynaptic conductance of the
distal driving spikes, our distal inputs have induced spiking activity
in the pyramidal neurons on several cycles of the drive, resulting in a
sharp and rapidly oscillating dipole waveform.</p>
<p>In the most recent set of instructions, we increased the frequency
range that our spectrograms should display. If you then create a
spectrogram using the instructions provided in previous steps, you
should see the following:</p>
<section class="stylefig">
<h3>Figure 24</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/HighFreqSpiking_Spect.png" /></p>
</section>
<p>The corresponding dipole spectrogram shows broadband spiking from
~60-120 Hz. This type of activity is not typically seen in EEG or MEG
data, and hence unlikely to underlie macroscale recordings.</p>
<p>Next, We can verify that the neurons are spiking by looking at the
spiking raster plots. Do the following:</p>
<ol type="1">
<li>Click on the <code>Visualization</code> tab.</li>
<li>Click on the <code>Layout template</code> dropdown menu and select
<code>Dipole Layers-Spikes (1x1)</code>.</li>
<li>Click on the <code>Dataset</code> dropdown menu and select the
<strong>most recent</strong> simulation name, which is
<code>HighFreqSpiking</code>.</li>
<li>Finally, click the <code>Make Figure</code> button.</li>
</ol>
<section class="stylefig">
<h3>Figure 25</h3>
<p><img
src="https://raw.githubusercontent.com/jonescompneurolab/jones-website/master/images/textbook/content/06_alpha_beta/images/HighFreqSpiking_SpikingOverlay.png" /></p>
</section>
<p>In this new plot, the grey lines correspond to each layer’s
contribution to the previously-seen dipole signals. The other colors
represent spikes of each cell population. Notice that highly synchronous
neuronal spiking in each population coincides with the high-frequency
events seen in the dipole signals. The high-frequency waveforms are
induced by the pyramidal neurons spiking, which create rapid,
back-propagating action potentials and repolarization of the
dendrites.</p>
<!-- ### 9.3.1 Exercise for further exploration -->
<!-- ### 8.3.1 Exercise for further exploration -->
<h3>7.3.1 Exercise for further exploration</h3>
<p>View the contribution of Layer 2/3 and Layer 5 to the net current
dipole waveform and compare with the spiking activity in each
population. How do each contribute? Try also to change the proximal
input parameters instead of the distal input parameters. Can you elicit
high-frequency spiking using proximal input changes only?</p>
<p>Adjust one of the parameters regulating the local network
connections. What happens?</p>
<p><a id="toc-10"></a></p>
<!-- Commenting this section out due to temporary removal of all data loading in this tutorial. -->
<!-- <\!-- ## 10. Have fun exploring your own data! -\-> -->
<!-- <\!-- ## 9. Have fun exploring your own data! -\-> -->
<!-- ## 8. Have fun exploring your own data! -->
<!-- <\!-- Follow sections 1-9 above using your data and parameter adjustments based on your own hypotheses. -\-> -->
<!-- <\!-- Follow sections 1-8 above using your data and parameter adjustments based on your own hypotheses. -\-> -->
<!-- Follow sections 1-7 above using your data and parameter adjustments based on your own hypotheses. -->
<h2 class="unnumbered">References</h2>
<div id="refs" class="references csl-bib-body hanging-indent"
data-entry-spacing="0" role="list">
<div id="ref-hughes_thalamic_2005" class="csl-entry" role="listitem">
Hughes, Stuart W., and Vincenzo Crunelli. 2005. <span>“Thalamic
<span>Mechanisms</span> of <span>EEG</span> <span>Alpha</span>
<span>Rhythms</span> and <span>Their</span> <span>Pathological</span>
<span>Implications</span>.”</span> <em>The Neuroscientist</em> 11 (4):
357–72. <a
href="https://doi.org/10.1177/1073858405277450">https://doi.org/10.1177/1073858405277450</a>.
</div>
<div id="ref-jones_thalamic_2001" class="csl-entry" role="listitem">
Jones, Edward G. 2001. <span>“The Thalamic Matrix and Thalamocortical
Synchrony.”</span> <em>Trends in Neurosciences</em> 24 (10): 595–601. <a
href="https://doi.org/10.1016/S0166-2236(00)01922-6">https://doi.org/10.1016/S0166-2236(00)01922-6</a>.
</div>
<div id="ref-jones_when_2016" class="csl-entry" role="listitem">
Jones, Stephanie R. 2016. <span>“When Brain Rhythms Aren’t
<span>‘Rhythmic’</span>: Implication for Their Mechanisms and
Meaning.”</span> <em>Current Opinion in Neurobiology</em>, Systems
neuroscience, 40 (October): 72–80. <a
href="https://doi.org/10.1016/j.conb.2016.06.010">https://doi.org/10.1016/j.conb.2016.06.010</a>.
</div>
<div id="ref-jones_quantitative_2009" class="csl-entry" role="listitem">
Jones, Stephanie R., Dominique L. Pritchett, Michael A. Sikora, Steven
M. Stufflebeam, Matti Hämäläinen, and Christopher I. Moore. 2009.
<span>“Quantitative <span>Analysis</span> and <span>Biophysically</span>
<span>Realistic</span> <span>Neural</span> <span>Modeling</span> of the
<span>MEG</span> <span>Mu</span> <span>Rhythm</span>:
<span>Rhythmogenesis</span> and <span>Modulation</span> of
<span>Sensory</span>-<span>Evoked</span> <span>Responses</span>.”</span>
<em>Journal of Neurophysiology</em> 102 (6): 3554–72. <a
href="https://doi.org/10.1152/jn.00535.2009">https://doi.org/10.1152/jn.00535.2009</a>.
</div>
<div id="ref-sherman_neural_2016" class="csl-entry" role="listitem">
Sherman, Maxwell A., Shane Lee, Robert Law, Saskia Haegens, Catherine A.
Thorn, Matti S. Hämäläinen, Christopher I. Moore, and Stephanie R.
Jones. 2016. <span>“Neural Mechanisms of Transient Neocortical Beta
Rhythms: <span>Converging</span> Evidence from Humans, Computational
Modeling, Monkeys, and Mice.”</span> <em>Proceedings of the National
Academy of Sciences</em> 113 (33): E4885–94. <a
href="https://doi.org/10.1073/pnas.1604135113">https://doi.org/10.1073/pnas.1604135113</a>.
</div>
<div id="ref-zhu_relationship_2009" class="csl-entry" role="listitem">
Zhu, Zhao, Johanna M. Zumer, Marianne E. Lowenthal, Jeff Padberg, Gregg
H. Recanzone, Leah A. Krubitzer, Srikantan S. Nagarajan, and Elizabeth
A. Disbrow. 2009. <span>“The Relationship Between Magnetic and
Electrophysiological Responses to Complex Tactile Stimuli.”</span>
<em>BMC Neuroscience</em> 10 (1): 4. <a
href="https://doi.org/10.1186/1471-2202-10-4">https://doi.org/10.1186/1471-2202-10-4</a>.
</div>
<div id="ref-ziegler_transformations_2010" class="csl-entry"
role="listitem">
Ziegler, David A., Dominique L. Pritchett, Paymon Hosseini-Varnamkhasti,
Suzanne Corkin, Matti Hämäläinen, Christopher I. Moore, and Stephanie R.
Jones. 2010. <span>“Transformations in Oscillatory Activity and Evoked
Responses in Primary Somatosensory Cortex in Middle Age: <span>A</span>
Combined Computational Neural Modeling and <span>MEG</span>
Study.”</span> <em>NeuroImage</em> 52 (3): 897–912. <a
href="https://doi.org/10.1016/j.neuroimage.2010.02.004">https://doi.org/10.1016/j.neuroimage.2010.02.004</a>.
</div>
</div>
        <!-- footer area -->
        <!----------------->
        <div class="footer-area">
            <div class="previous-area" data-link="/website_redesign/content/05_erps/hnn_core.html">
                <div class="previous-icon">
                    <svg class="svg-arrow" width="25" height="25" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path class="arrow-path" d="M15 5L9 12L15 19" />
                    </svg>
                </div>
                <div class="previous-text">
                    <p>Previous</p>
                    <a>3.2 API Tutorial of ERPs Simulation</a>
                </div>
            </div>
            <div class="next-area" data-link="/website_redesign/content/06_alpha_beta/api.html">
                <div class="next-text">
                    <p>Next</p>
                    <a>4.2 API Tutorial of Alpha/Beta Rhythms</a>
                </div>
                <div class="next-icon">
                    <svg class="svg-arrow" width="25" height="25" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path class="arrow-path" d="M15 5L9 12L15 19" />
                    </svg>
                </div>
            </div>
        </div> <!-- close footer -->
    </div> <!-- close content -->
    </div> <!-- close content wrapper -->
</div> <!-- close main -->
<script>
    // ----------------------------------------
    // Manage footer
    // ----------------------------------------
    // This function will update the footer links when a page is loaded
    // locally so that naivagation remains functional without a server
    // Note: this solution is specific to MacOS
    document.addEventListener("DOMContentLoaded", function() {
        if (window.location.protocol === "file:") {
            // Get the current local directory path
            const currentDir = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'));

            // Process both previous and next links
            document.querySelectorAll('.previous-area, .next-area').forEach(function(area) {
                const link = area.getAttribute('data-link');
                
                if (link && link.startsWith("/")) {
                    // Extract the local root directory
                    const rootPath = currentDir.split("/website_redesign/")[0];
                    // Prepend root path to link
                    const resolvedLink = "file://" + rootPath + link;
                    area.setAttribute("data-link", resolvedLink);
                }
            });
        }
    });
    // Hide the area if data-link is 'None'
    document.querySelectorAll('.previous-area, .next-area').forEach(function(area) {
        if (area.getAttribute('data-link') === 'None') {
            area.style.display = 'none'; 
        }
    });

    // Redirect to the specified link
    document.querySelectorAll('.previous-area, .next-area').forEach(function(area) {
        area.addEventListener('click', function() {
            window.location.href = area.getAttribute('data-link');
        });
    });

    // ----------------------------------------
    // Manage sidebar
    // ----------------------------------------
    let isSidebarOpen = true; // Sidebar is initially open
    let isSidebarFullyOpen = true; // Sidebar is fully open
    const maxWidth = '350px';

    function toggleNav() {
        const sidebar = document.getElementById("mySidebar");
        const main = document.getElementById("main");
        const topbar = document.querySelector(".topbar");

        // Toggle sidebar state
        if (isSidebarOpen) {
            sidebar.style.width = "0";
            main.style.marginLeft = "0";
            topbar.style.marginLeft = "0";
            topbar.style.width = "100%";
            isSidebarFullyOpen = false;
        } else {
            sidebar.style.width = maxWidth;
            main.style.marginLeft = maxWidth;
                // match margin to new width
            topbar.style.marginLeft = maxWidth;
            topbar.style.width = `calc(100% - ${maxWidth})`;
                // adjust topbar width
        }

        // Toggle the sidebar state
        isSidebarOpen = !isSidebarOpen;

        // Store the sidebar state in localStorage
        localStorage.setItem("sidebarState", isSidebarOpen ? "open" : "closed");
    }

    // Always listen for the transitionend on the sidebar
    const sidebar = document.getElementById("mySidebar");
    sidebar.addEventListener('transitionend', function() {
        if (sidebar.style.width === maxWidth) {
            // Sidebar has fully opened
            isSidebarFullyOpen = true;
        } else {
            // Sidebar is not fully open
            isSidebarFullyOpen = false;
        }
    });

    // Open the sidebar on page load
    // -----------------------------

    // Apply sidebar state before the page renders
    // Added to help with initial page "flicker" as the position is
    // calculated and applied
    const savedState = localStorage.getItem("sidebarState");
    if (savedState === "closed") {
        document.body.classList.add("sidebar-closed");
    } else {
        document.body.classList.add("sidebar-open");
    }

    window.onload = function() {
        const sidebar = document.getElementById("mySidebar");
        const main = document.getElementById("main");
        const topbar = document.querySelector(".topbar");

        // Retrieve stored state
        const savedState = localStorage.getItem("sidebarState");

        // Determine initial state
        if (savedState === "closed") {
            sidebar.style.width = "0";
            main.style.marginLeft = "0";
            topbar.style.marginLeft = "0";
            topbar.style.width = "100%";
            isSidebarOpen = false;
            isSidebarFullyOpen = false;
        } else {
            sidebar.style.width = maxWidth;
            main.style.marginLeft = maxWidth;
            topbar.style.marginLeft = maxWidth;
            topbar.style.width = `calc(100% - ${maxWidth})`;
            isSidebarOpen = true;
            isSidebarFullyOpen = true;
        }

        // Disable transition for the initial state
        sidebar.style.transition = "none";
        main.style.transition = "none";
        topbar.style.transition = "none";

        // Re-enable transition for subsequent toggles
        setTimeout(() => {
            sidebar.style.transition = "width 0.5s";
            main.style.transition = "margin-left 0.5s";
            topbar.style.transition = "margin-left 0.5s, width 0.5s";
        }, 10);
    }

    function toggleSubmenu(event) {
        const header = event.target.closest('#sidebar-header');
            // Get the clicked header
        const submenu = header.nextElementSibling;
            // Get the submenu
        const toggleIcon = header.querySelector('.toggle-icon');
            // Get the icon

        if (submenu && submenu.classList.contains('submenu')) {
            submenu.classList.toggle('open'); 
                // Toggle the 'open' class to control visibility
            toggleIcon.textContent = submenu.classList.contains('open') ? '-' : '+'; 
                // Update icon
        }
    }

    // Resolve sidebar links for local development
    // -------------------------------------------
    // This function will update the sidebar links when a page is loaded
    // locally so that sidebar naivagation remains functional without a server
    // Note: this solution is specific to MacOS
    document.addEventListener("DOMContentLoaded", function() {
        if (window.location.protocol === "file:") {
            // get the current local directory path
            const currentDir = window.location.pathname.substring(0, window.location.pathname.lastIndexOf('/'));

            // get 'absolute' links with root of 'website_redesign'
            const links = document.querySelectorAll("#mySidebar a");
            links.forEach(link => {
                const href = link.getAttribute("href");

                if (href && href.startsWith("/")) {
                    // extract the local root directory
                    const rootPath = currentDir.split("/website_redesign/")[0];
                    // prepend root path to link
                    const resolvedHref = "file://" + rootPath + href;
                    link.setAttribute("href", resolvedHref);
                }
            });

            // Update image sources for icons
            const images = document.querySelectorAll(".social-icons img, .menu-icons img");
            images.forEach(img => {
                const src = img.getAttribute("src");

                if (src && src.startsWith("/")) {
                    // extract the local root directory
                    const rootPath = currentDir.split("/website_redesign/")[0];
                    // prepend root path to image source
                    const resolvedSrc = "file://" + rootPath + src;
                    img.setAttribute("src", resolvedSrc);
                }
            });
        }
    });

    // Custom tooltips for the sidebar
    // -------------------------------
    // Flag to track tooltip visibility
    let isTooltipVisible = false;

    // Add text to the 'sidebar-tooltip' attribute for sidebar anchor tags
    document.querySelectorAll('.sidebar a').forEach(anchor => {
        const cleanedText = anchor.textContent.replace(/[+\-]/g, '').trim();
        anchor.setAttribute('sidebar-tooltip', cleanedText);
    });

    // Handle sidebar tooltips
    document.querySelectorAll('.sidebar a').forEach(function(link) {
        link.addEventListener('mouseenter', function(event) {
            const tooltipText = event.target.getAttribute('sidebar-tooltip');
            
            if (!tooltipText || isTooltipVisible || !isSidebarFullyOpen) return; // Only show tooltip if none is visible

            // Check if the text is overflowing
            if (event.target.scrollWidth > event.target.offsetWidth) {
                const delay = 500; // Set the delay time (in ms), adjust as needed

                // Create the tooltip after the delay
                setTimeout(function() {
                    // Remove any existing tooltips
                    const existingTooltip = document.querySelector('.sidebar-tooltip');
                    if (existingTooltip) {
                        existingTooltip.remove();
                    }

                    // Create the tooltip element dynamically
                    const tooltip = document.createElement('div');
                    tooltip.classList.add('sidebar-tooltip');  // Use the existing class
                    tooltip.innerText = tooltipText;

                    // Append the tooltip to the sidebar container
                    const sidebarContainer = document.querySelector('.sidebar');
                    sidebarContainer.appendChild(tooltip);

                    // Get the position of the link and the sidebar container
                    const rect = event.target.getBoundingClientRect();
                    const sidebarRect = sidebarContainer.getBoundingClientRect();

                    // Position the tooltip relative to the sidebar container
                    tooltip.style.position = 'absolute';
                    tooltip.style.left = `${rect.left - sidebarRect.left + sidebarContainer.scrollLeft + 20}px`;
                    tooltip.style.top = `${rect.bottom - sidebarRect.top + sidebarContainer.scrollTop + 5}px`;

                    // Make sure the tooltip is visible
                    tooltip.style.opacity = '1';

                    // Set the flag to true indicating that the tooltip is visible
                    isTooltipVisible = true;
                }, delay); // Delay the tooltip creation
            }
        });

        link.addEventListener('mouseleave', function(event) {
            // Remove the tooltip when the mouse leaves
            const tooltip = document.querySelector('.sidebar-tooltip');
            if (tooltip) {
                tooltip.remove();
            }

            // Reset the flag to false when the tooltip is removed
            isTooltipVisible = false;
        });
    });

    // Close all open submenus in the sidebar
    // --------------------------------------
    document.addEventListener("DOMContentLoaded", function() {
        // Function to close all open submenus in the navbar
        function closeAllSubmenus() {
            const allSubmenus = document.querySelectorAll('.submenu.open'); // Select all open submenus
            allSubmenus.forEach(submenu => {
                submenu.classList.remove('open'); // Remove 'open' class to collapse
                const toggleIcon = submenu.previousElementSibling.querySelector('.toggle-icon');
                if (toggleIcon) {
                    toggleIcon.textContent = '+'; // Reset icon to '+'
                }
            });
        }

        // Add functionality to collapse button (SVG icon)
        const collapseIcon = document.querySelector('.collapse-icon');
        if (collapseIcon) {
            collapseIcon.addEventListener('click', function(event) {
                event.stopPropagation(); // Prevent event propagation to avoid unwanted behavior
                closeAllSubmenus(); // Close all open submenus when the icon is clicked
            });
        }
    });

    // Keep the current page open in the sidebar
    // -----------------------------------------
    document.addEventListener("DOMContentLoaded", function () {
        // Get the full path relative to the 'content' folder
        const currentPage = window.location.pathname.split("/content/")[1].split("?")[0];

        // Find the active link using the full path
        const activeLink = document.querySelector(`#mySidebar a[href$='${currentPage}']`);

        if (activeLink) {
            // Apply the active class
            activeLink.classList.add("active");
             // Find the closest submenu
            const submenu = activeLink.closest('.submenu');

            if (submenu) {
                // Keep the submenu open
                submenu.classList.add('open');
                const toggleIcon = submenu.previousElementSibling.querySelector('.toggle-icon');

                if (toggleIcon) {
                    // Ensure the toggle icon reflects the open state
                    toggleIcon.textContent = '-';
                }
            }
        }
    });

    // ------------------------------
    // Font size buttons and dropdown
    // ------------------------------
    document.addEventListener("DOMContentLoaded", function() {
        const content = document.getElementById("content");

        // Retrieve and apply the saved font size
        const savedFontSize = localStorage.getItem("fontSize");
        if (savedFontSize && content) {
            content.style.fontSize = savedFontSize + "px";
        }
    });

    function increaseFontSize() {
        event.stopPropagation();  // Prevent dropdown from closing
        const content = document.getElementById("content");
        const currentSize = parseFloat(window.getComputedStyle(content).fontSize);
        const newSize = currentSize + 1;

        content.style.fontSize = newSize + "px";

        // save font size to localStorage
        localStorage.setItem("fontSize", newSize);
    }

    function decreaseFontSize() {
        event.stopPropagation();  // Prevent dropdown from closing
        const content = document.getElementById("content");
        const currentSize = parseFloat(window.getComputedStyle(content).fontSize);
        const newSize = currentSize - 1;

        content.style.fontSize = newSize + "px";

        // save font size to localStorage
        localStorage.setItem("fontSize", newSize);
    }

    // Dropdown for font buttons
    function toggleDropdown() {
        const dropdownContent = document.querySelector('.dropdown-content');
        dropdownContent.style.display = dropdownContent.style.display === 'block' ? 'none' : 'block';
    }

    // Open/close dropdown on click of the button
    document.getElementById('dropdownButton').onclick = function(event) {
        event.stopPropagation();  // Prevent the click from triggering the window.onclick event
        toggleDropdown();
    };

    // Close dropdown if clicking outside
    window.onclick = function(event) {
        const dropdownContent = document.querySelector('.dropdown-content');
        if (!event.target.closest('.dropdown')) {  // Close if click outside the dropdown
            dropdownContent.style.display = 'none';
        }
    };

    // ----------------------------------------
    // Toggle between light and dark themes
    // ----------------------------------------
    // Wait for the DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', () => {
        const themeToggle = document.querySelector('.theme-toggle');
        const sidebar = document.querySelector('.sidebar');
        const sunSVG = `
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512">
                <path d="M361.5 1.2c5 2.1 8.6 6.6 9.6 11.9L391 121l107.9 19.8c5.3 1 9.8 4.6 11.9 9.6s1.5 10.7-1.6 15.2L446.9 256l62.3 90.3c3.1 4.5 3.7 10.2 1.6 15.2s-6.6 8.6-11.9 9.6L391 391 371.1 498.9c-1 5.3-4.6 9.8-9.6 11.9s-10.7 1.5-15.2-1.6L256 446.9l-90.3 62.3c-4.5 3.1-10.2 3.7-15.2 1.6s-8.6-6.6-9.6-11.9L121 391 13.1 371.1c-5.3-1-9.8-4.6-11.9-9.6s-1.5-10.7 1.6-15.2L65.1 256 2.8 165.7c-3.1-4.5-3.7-10.2-1.6-15.2s6.6-8.6 11.9-9.6L121 121 140.9 13.1c1-5.3 4.6-9.8 9.6-11.9s10.7-1.5 15.2 1.6L256 65.1 346.3 2.8c4.5-3.1 10.2-3.7 15.2-1.6zM160 256a96 96 0 1 1 192 0 96 96 0 1 1 -192 0zm224 0a128 128 0 1 0 -256 0 128 128 0 1 0 256 0z"></path>
            </svg>
        `;
        const moonSVG = `
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 384 512">
                <path d="M223.5 32C100 32 0 132.3 0 256S100 480 223.5 480c60.6 0 115.5-24.2 155.8-63.4c5-4.9 6.3-12.5 3.1-18.7s-10.1-9.7-17-8.5c-9.8 1.7-19.8 2.6-30.1 2.6c-96.9 0-175.5-78.8-175.5-176c0-65.8 36-123.1 89.3-153.3c6.1-3.5 9.2-10.5 7.7-17.3s-7.3-11.9-14.3-12.5c-6.3-.5-12.6-.8-19-.8z"></path>
            </svg>
        `;

        // Check the saved theme preference
        const savedTheme = localStorage.getItem('theme');
        if (savedTheme) {
            document.body.classList.toggle('dark-mode', savedTheme === 'dark');
            themeToggle.innerHTML = savedTheme === 'dark' ? moonSVG : sunSVG;
            sidebar.classList.toggle('dark-mode', savedTheme === 'dark');
        } else {
            // Default to light theme if no saved preference
            themeToggle.innerHTML = sunSVG;
        }

        // Add click event to toggle theme
        themeToggle.addEventListener('click', () => {
            const isDarkMode = document.body.classList.toggle('dark-mode');
            themeToggle.innerHTML = isDarkMode ? moonSVG : sunSVG;
            sidebar.classList.toggle('dark-mode', isDarkMode);
            localStorage.setItem('theme', isDarkMode ? 'dark' : 'light');
        });
    });

    // ----------------------------------------
    // Add a clickable '#' for each heading 
    // that directs to that heading
    // ----------------------------------------
    document.addEventListener("DOMContentLoaded", function () {
        document.querySelectorAll("h1, h2, h3, h4, h5, h6").forEach(header => {
            if (!header.id) {
                let text = header.textContent.trim().toLowerCase().replace(/\s+/g, '-').replace(/[^\w\-]/g, '');
                header.id = text;
            }

            // Avoid adding duplicate links if the script runs multiple times
            if (!header.querySelector(".headerlink")) {
                let link = document.createElement("a");
                link.className = "headerlink";
                link.href = `#${header.id}`;
                link.title = "Link to this heading";
                link.textContent = " #"; // Space before # for spacing

                header.appendChild(link);
            }
        });
    });

</script>

<!------------------------ #
# Code syntax highlighting #
# ------------------------->
<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>

<link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" rel="stylesheet" />

<script>
    // Remove the leading whitespace/newlines around code blocks 
    // caused by the html structure used for readability
    document.addEventListener("DOMContentLoaded", function() {
        // Select all code blocks
        const codeBlocks = document.querySelectorAll('.code-cell code.language-python');

        codeBlocks.forEach(function(block) {
            // Apply syntax highlighting to the code block
            // Note: The below line is not needed with this setup
            //  but may be useful in the case that the method
            //  is later changed
            // Prism.highlightElement(block);

            // Get the code with highlighted classes
            const highlightedHTML = block.innerHTML;

            // Remove leading/trailing whitespace/newlines
            block.innerHTML = highlightedHTML.trim();
        });

        // Select all output-code blocks
        const outputBlocks = document.querySelectorAll('.output-cell .output-code');

        outputBlocks.forEach(function(block) {
            // Remove unwanted leading/trailing whitespace or newlines
            block.textContent = block.textContent.trim();
        });
    });

</script>

</body>
</html>